<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HACC: HACCGPM::serial Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HACC<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d5/d07/namespaceHACCGPM_1_1serial.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">HACCGPM::serial Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html">MemoryManager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad9fb99027bd0e8c4666c28a5b85d419e"><td class="memItemLeft" align="right" valign="top">__device__ __forceinline__ int3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ad9fb99027bd0e8c4666c28a5b85d419e">get_index</a> (int idx, int ng)</td></tr>
<tr class="separator:ad9fb99027bd0e8c4666c28a5b85d419e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adebf563a2ff1ace956181e3a26ea6cb2"><td class="memItemLeft" align="right" valign="top">__device__ __forceinline__ float3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#adebf563a2ff1ace956181e3a26ea6cb2">get_kmodes</a> (int3 idx3d, int ng, double d)</td></tr>
<tr class="separator:adebf563a2ff1ace956181e3a26ea6cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7b5439a4f273a0b5136c983988630c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#afc7b5439a4f273a0b5136c983988630c">UpdatePositions</a> (float4 *d_pos, float4 *d_vel, <a class="el" href="../../db/df0/classHACCGPM_1_1Timestepper.html">HACCGPM::Timestepper</a> ts, float frac, int ng, int blockSize, int calls=0)</td></tr>
<tr class="separator:afc7b5439a4f273a0b5136c983988630c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e294634a2863de32ac3943d827c68c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a2e294634a2863de32ac3943d827c68c8">UpdateVelocities</a> (float4 *d_vel, float4 *d_grad, float4 *d_pos, <a class="el" href="../../db/df0/classHACCGPM_1_1Timestepper.html">HACCGPM::Timestepper</a> ts, int ng, int blockSize, int calls=0)</td></tr>
<tr class="separator:a2e294634a2863de32ac3943d827c68c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8b4ba312818288e4c808753bc322702"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ac8b4ba312818288e4c808753bc322702">CIC</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *d_grid, float4 *d_pos, int ng, int blockSize, int calls=0)</td></tr>
<tr class="separator:ac8b4ba312818288e4c808753bc322702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab791cb661ee56bd0e61992d605b9dd80"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ab791cb661ee56bd0e61992d605b9dd80">get_fscal</a> (double m_aa, double m_adot, double m_omega_cb)</td></tr>
<tr class="separator:ab791cb661ee56bd0e61992d605b9dd80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae31040d68a45a644d5e079616e99061c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ae31040d68a45a644d5e079616e99061c">get_adot</a> (double m_aa, double m_w, double m_wa, double m_omega_cb, double m_omega_radiation, double m_f_nu_massless, double m_f_nu_massive, double m_omega_matter, double m_omega_nu)</td></tr>
<tr class="separator:ae31040d68a45a644d5e079616e99061c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56967323163b51e64180118159a654c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a56967323163b51e64180118159a654c2">writeOutput</a> (char *fname, float4 *d_pos, float4 *d_vel, int ng, int calls=0)</td></tr>
<tr class="separator:a56967323163b51e64180118159a654c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89c1764f5268d9a5780657b7a25f780"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#aa89c1764f5268d9a5780657b7a25f780">GetPowerSpectrum</a> (float4 *d_pos, <a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *d_grid, int ng, double rl, int nbins, const char *fname, int nfolds, int blockSize, int calls=0)</td></tr>
<tr class="separator:aa89c1764f5268d9a5780657b7a25f780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c364758c8fc90a0a3d8ac62168c2e4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a2c364758c8fc90a0a3d8ac62168c2e4c">GetFinerPowerSpectrum</a> (float4 *d_temp_pos, int ng, double rl, int nbins, int fftNg, const char *fname, int blockSize)</td></tr>
<tr class="separator:a2c364758c8fc90a0a3d8ac62168c2e4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fae33fb8958064c643b8fe76740ee0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a4fae33fb8958064c643b8fe76740ee0a">GenerateDisplacementIC</a> (const char *params_file, <a class="el" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html">HACCGPM::serial::MemoryManager</a> *mem, int ng, double rl, double z, double deltaT, double fscal, int seed, int blockSize, int calls=0)</td></tr>
<tr class="separator:a4fae33fb8958064c643b8fe76740ee0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad482d1daabaede6890859e0934d75a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a3ad482d1daabaede6890859e0934d75a">Solve</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *d_rho, <a class="el" href="../../da/d0d/haccgpm_8hpp.html#a2f67acc29a084b658dd371975fb27bd8">hostFFT_t</a> *d_greens, int ng, int blockSize, int calls=0)</td></tr>
<tr class="separator:a3ad482d1daabaede6890859e0934d75a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38be02d5fae626750b7f03b40a40dab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#aa38be02d5fae626750b7f03b40a40dab">SolveGradient</a> (float4 *d_grad, <a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *d_rho, <a class="el" href="../../da/d0d/haccgpm_8hpp.html#a2f67acc29a084b658dd371975fb27bd8">hostFFT_t</a> *d_greens, int ng, int blockSize, int calls=0)</td></tr>
<tr class="separator:aa38be02d5fae626750b7f03b40a40dab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba96f26caa0971a861e23d251bdca488"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#aba96f26caa0971a861e23d251bdca488">InitGreens</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a2f67acc29a084b658dd371975fb27bd8">hostFFT_t</a> *d_greens, int ng, int blockSize, int calls=0)</td></tr>
<tr class="separator:aba96f26caa0971a861e23d251bdca488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33ccdffdab832aa754528e05d4255b7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c">forward_fft</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *data, <a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *out, int ng, int calls=0)</td></tr>
<tr class="separator:a33ccdffdab832aa754528e05d4255b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7528d9faa62dea23e52934a46ff118b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af7528d9faa62dea23e52934a46ff118b">forward_fft</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *data, int ng, int calls=0)</td></tr>
<tr class="separator:af7528d9faa62dea23e52934a46ff118b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8d988b0ca5106d342dc9591708ff789"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">backward_fft</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *data, <a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *out, int ng, int calls=0)</td></tr>
<tr class="separator:af8d988b0ca5106d342dc9591708ff789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91270d38401a52dacf6e8e04acc903da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a91270d38401a52dacf6e8e04acc903da">backward_fft</a> (<a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *data, int ng, int calls=0)</td></tr>
<tr class="separator:a91270d38401a52dacf6e8e04acc903da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61abf058f64a8c48cb425ba0aa3cd3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a61abf058f64a8c48cb425ba0aa3cd3d8">fft_cache_plan</a> (int ng)</td></tr>
<tr class="separator:a61abf058f64a8c48cb425ba0aa3cd3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873c8a9f36dff354099861a9cc5a7da2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a873c8a9f36dff354099861a9cc5a7da2">printCICTimes</a> ()</td></tr>
<tr class="separator:a873c8a9f36dff354099861a9cc5a7da2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e499b679db21f46e02946401a4ed44f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a1e499b679db21f46e02946401a4ed44f">printFFTTimes</a> ()</td></tr>
<tr class="separator:a1e499b679db21f46e02946401a4ed44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a233115e291533b87d96cc0baeadc74cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a233115e291533b87d96cc0baeadc74cd">printPowerTimes</a> ()</td></tr>
<tr class="separator:a233115e291533b87d96cc0baeadc74cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e7cdba1605fe8248b3f1306667c5d5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a7e7cdba1605fe8248b3f1306667c5d5c">printOutputTimes</a> ()</td></tr>
<tr class="separator:a7e7cdba1605fe8248b3f1306667c5d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af8d988b0ca5106d342dc9591708ff789" name="af8d988b0ca5106d342dc9591708ff789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8d988b0ca5106d342dc9591708ff789">&#9670;&#160;</a></span>backward_fft() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::backward_fft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00169">169</a> of file <a class="el" href="../../d2/df9/ffts_8cu_source.html">ffts.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  169</span>                                                                                      {</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span><span class="preprocessor">    #ifdef VerboseFFT</span></div>
<div class="line"><span class="lineno">  176</span>    printf(<span class="stringliteral">&quot;%sbackward_fft (out of place) was called with\n%s   ng %d\n&quot;</span>,indent,indent,ng);</div>
<div class="line"><span class="lineno">  177</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    cufftHandle plan;</div>
<div class="line"><span class="lineno">  180</span><span class="preprocessor">    #ifdef UsePlanManager</span></div>
<div class="line"><span class="lineno">  181</span>    plan = <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a97f9c40ffced254ea51e0a9e561d6cc3">plan_manager</a>.<a class="code hl_function" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0">get_plan</a>(ng,calls+1);</div>
<div class="line"><span class="lineno">  182</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">  183</span>    printf(<span class="stringliteral">&quot;%s   Creating plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">if</span> (cufftPlan3d(&amp;plan, ng, ng, ng, CUFFT_Z2Z) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  185</span>        printf(<span class="stringliteral">&quot;CUFFT error: Plan creation failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  186</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  187</span>    };</div>
<div class="line"><span class="lineno">  188</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_t = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    printf(<span class="stringliteral">&quot;%s   Executing Z2Z CUFFT_INVERSE\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">if</span> (cufftExecZ2Z(plan, data, out, CUFFT_INVERSE) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  194</span>        printf(<span class="stringliteral">&quot;CUFFT error: ExecZ2Z Backward failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  195</span>        <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno">  196</span>    }</div>
<div class="line"><span class="lineno">  197</span>    cudaDeviceSynchronize();</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span><span class="preprocessor">    #ifndef UsePlanManager</span></div>
<div class="line"><span class="lineno">  200</span>    printf(<span class="stringliteral">&quot;%s   Destroying plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  201</span>    cufftDestroy(plan);</div>
<div class="line"><span class="lineno">  202</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  205</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_time = plan_t - start;</div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  207</span>    printf(<span class="stringliteral">&quot;%s   backward_fft (out of place) took %llu us (%llu us planning)\n&quot;</span>,indent,t,plan_time);</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10c41d1c7b046f472f0865cbc2f6f1d1">FFT_BACKWARD_CALLS_OP</a>++;</div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10b151b803e5dc48583ce4c1323e844b">FFT_BACKWARD_TIME_OP</a> += t;</div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a71619cec016a53624323fd9c63fadf8c">FFT_BACKWARD_PLAN_TIME_OP</a> += plan_time;</div>
<div class="line"><span class="lineno">  211</span>}</div>
<div class="ttc" id="accamb_8c_html_aede6a850e442b96dd236d1bed8bf19e5"><div class="ttname"><a href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a></div><div class="ttdeci">#define getIndent(calls)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc2/ccamb_8c_source.html#l00009">ccamb.c:9</a></div></div>
<div class="ttc" id="aclassPlanManager_html_a42f7d34dc999efd9bb3d2665537101e0"><div class="ttname"><a href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0">PlanManager::get_plan</a></div><div class="ttdeci">cufftHandle get_plan(int ng, int calls)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00046">ffts.cu:46</a></div></div>
<div class="ttc" id="affts_8cu_html_a10b151b803e5dc48583ce4c1323e844b"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a10b151b803e5dc48583ce4c1323e844b">FFT_BACKWARD_TIME_OP</a></div><div class="ttdeci">CPUTimer_t FFT_BACKWARD_TIME_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00017">ffts.cu:17</a></div></div>
<div class="ttc" id="affts_8cu_html_a10c41d1c7b046f472f0865cbc2f6f1d1"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a10c41d1c7b046f472f0865cbc2f6f1d1">FFT_BACKWARD_CALLS_OP</a></div><div class="ttdeci">int FFT_BACKWARD_CALLS_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00023">ffts.cu:23</a></div></div>
<div class="ttc" id="affts_8cu_html_a71619cec016a53624323fd9c63fadf8c"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a71619cec016a53624323fd9c63fadf8c">FFT_BACKWARD_PLAN_TIME_OP</a></div><div class="ttdeci">CPUTimer_t FFT_BACKWARD_PLAN_TIME_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00018">ffts.cu:18</a></div></div>
<div class="ttc" id="affts_8cu_html_a97f9c40ffced254ea51e0a9e561d6cc3"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a97f9c40ffced254ea51e0a9e561d6cc3">plan_manager</a></div><div class="ttdeci">PlanManager plan_manager</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00072">ffts.cu:72</a></div></div>
<div class="ttc" id="ahaccgpm_8hpp_html_a78588985bccaffcba4aa40467d7961d6"><div class="ttname"><a href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a></div><div class="ttdeci">unsigned long long CPUTimer(unsigned long long start=0)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00014">haccgpm.hpp:14</a></div></div>
<div class="ttc" id="ahaccgpm_8hpp_html_aa790b6767cf9152c32b179d29c46e3ef"><div class="ttname"><a href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a></div><div class="ttdeci">unsigned long long CPUTimer_t</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00012">haccgpm.hpp:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00023">FFT_BACKWARD_CALLS_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00018">FFT_BACKWARD_PLAN_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00017">FFT_BACKWARD_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00046">PlanManager::get_plan()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, and <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00072">plan_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00267">GenerateDisplacementIC()</a>, <a class="el" href="../../d8/d93/solver_8cu_source.html#l00071">Solve()</a>, and <a class="el" href="../../d8/d93/solver_8cu_source.html#l00096">SolveGradient()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_af8d988b0ca5106d342dc9591708ff789_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_af8d988b0ca5106d342dc9591708ff789_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_af8d988b0ca5106d342dc9591708ff789_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_af8d988b0ca5106d342dc9591708ff789_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,219,56"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="302,5,386,31"/>
<area shape="poly" title=" " alt="" coords="219,29,287,22,288,27,219,34"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="267,55,421,80"/>
<area shape="poly" title=" " alt="" coords="219,52,253,55,253,61,219,57"/>
</map>
</div>

</div>
</div>
<a id="a91270d38401a52dacf6e8e04acc903da" name="a91270d38401a52dacf6e8e04acc903da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91270d38401a52dacf6e8e04acc903da">&#9670;&#160;</a></span>backward_fft() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::backward_fft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00213">213</a> of file <a class="el" href="../../d2/df9/ffts_8cu_source.html">ffts.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  213</span>                                                                    {</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span><span class="preprocessor">    #ifdef VerboseFFT</span></div>
<div class="line"><span class="lineno">  220</span>    printf(<span class="stringliteral">&quot;%sbackward_fft (in place) was called with\n%s   ng %d\n&quot;</span>,indent,indent,ng);</div>
<div class="line"><span class="lineno">  221</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    cufftHandle plan;</div>
<div class="line"><span class="lineno">  224</span><span class="preprocessor">    #ifdef UsePlanManager</span></div>
<div class="line"><span class="lineno">  225</span>    plan = <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a97f9c40ffced254ea51e0a9e561d6cc3">plan_manager</a>.<a class="code hl_function" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0">get_plan</a>(ng,calls+1);</div>
<div class="line"><span class="lineno">  226</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">  227</span>    printf(<span class="stringliteral">&quot;%s   Creating plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">if</span> (cufftPlan3d(&amp;plan, ng, ng, ng, CUFFT_Z2Z) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  229</span>        printf(<span class="stringliteral">&quot;CUFFT error: Plan creation failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  231</span>    };</div>
<div class="line"><span class="lineno">  232</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_t = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  234</span>    printf(<span class="stringliteral">&quot;%s   Executing Z2Z CUFFT_INVERSE\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> (cufftExecZ2Z(plan, data, data, CUFFT_INVERSE) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  236</span>        printf(<span class="stringliteral">&quot;CUFFT error: ExecZ2Z Backward failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno">  238</span>    }</div>
<div class="line"><span class="lineno">  239</span>    cudaDeviceSynchronize();</div>
<div class="line"><span class="lineno">  240</span><span class="preprocessor">    #ifndef UsePlanManager</span></div>
<div class="line"><span class="lineno">  241</span>    printf(<span class="stringliteral">&quot;%s   Destroying plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  242</span>    cufftDestroy(plan);</div>
<div class="line"><span class="lineno">  243</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  245</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_time = plan_t - start;</div>
<div class="line"><span class="lineno">  246</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  247</span>    printf(<span class="stringliteral">&quot;%s   backward_fft (in place) took %llu us (%llu us planning)\n&quot;</span>,indent,t,plan_time);</div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a8e917450629fec0bba13fe3ed19f9f3d">FFT_BACKWARD_CALLS_IP</a>++;</div>
<div class="line"><span class="lineno">  249</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c4af52d5f4a3d0d6497a788251a28e7">FFT_BACKWARD_TIME_IP</a> += t;</div>
<div class="line"><span class="lineno">  250</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a0a1088ef396eb179693acf3bcaf20059">FFT_BACKWARD_PLAN_TIME_IP</a> += plan_time;</div>
<div class="line"><span class="lineno">  251</span>}</div>
<div class="ttc" id="affts_8cu_html_a0a1088ef396eb179693acf3bcaf20059"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a0a1088ef396eb179693acf3bcaf20059">FFT_BACKWARD_PLAN_TIME_IP</a></div><div class="ttdeci">CPUTimer_t FFT_BACKWARD_PLAN_TIME_IP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00014">ffts.cu:14</a></div></div>
<div class="ttc" id="affts_8cu_html_a5c4af52d5f4a3d0d6497a788251a28e7"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a5c4af52d5f4a3d0d6497a788251a28e7">FFT_BACKWARD_TIME_IP</a></div><div class="ttdeci">CPUTimer_t FFT_BACKWARD_TIME_IP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00013">ffts.cu:13</a></div></div>
<div class="ttc" id="affts_8cu_html_a8e917450629fec0bba13fe3ed19f9f3d"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a8e917450629fec0bba13fe3ed19f9f3d">FFT_BACKWARD_CALLS_IP</a></div><div class="ttdeci">int FFT_BACKWARD_CALLS_IP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00022">ffts.cu:22</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00022">FFT_BACKWARD_CALLS_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00014">FFT_BACKWARD_PLAN_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00013">FFT_BACKWARD_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00046">PlanManager::get_plan()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, and <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00072">plan_manager</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a91270d38401a52dacf6e8e04acc903da_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a91270d38401a52dacf6e8e04acc903da_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a91270d38401a52dacf6e8e04acc903da_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a91270d38401a52dacf6e8e04acc903da_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,219,56"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="302,5,386,31"/>
<area shape="poly" title=" " alt="" coords="219,29,287,22,288,27,219,34"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="267,55,421,80"/>
<area shape="poly" title=" " alt="" coords="219,52,253,55,253,61,219,57"/>
</map>
</div>

</div>
</div>
<a id="ac8b4ba312818288e4c808753bc322702" name="ac8b4ba312818288e4c808753bc322702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8b4ba312818288e4c808753bc322702">&#9670;&#160;</a></span>CIC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::CIC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dce/cic_8cu_source.html#l00198">198</a> of file <a class="el" href="../../d6/dce/cic_8cu_source.html">cic.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  198</span>                                                                                           {</div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  202</span><span class="preprocessor">    #ifdef VerboseUpdate</span></div>
<div class="line"><span class="lineno">  203</span>    printf(<span class="stringliteral">&quot;%sCIC was called with\n%s   blockSize %d\n%s   numBlocks %d\n&quot;</span>,indent,indent,blockSize,indent,numBlocks);</div>
<div class="line"><span class="lineno">  204</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  205</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemset,d_grid,0,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ac76179fff32b3529b4a5d73452d35b9d">CIC_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d6/dce/cic_8cu.html#adc0dd2818da8e0af8703197df0746abe">CICKernel</a>,numBlocks,blockSize,d_grid,d_pos,ng,1.0f);</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  209</span>    printf(<span class="stringliteral">&quot;%s   CIC took %llu us\n&quot;</span>,indent,t);</div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ae55de4065f3d7f164bf46a83f62a5591">CIC_TIME</a> += t;</div>
<div class="line"><span class="lineno">  211</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a793ccc2e7f39360df20ee3f323e3fb8d">CIC_CALLS</a> += 1;</div>
<div class="line"><span class="lineno">  212</span>}</div>
<div class="ttc" id="acic_8cu_html_a793ccc2e7f39360df20ee3f323e3fb8d"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#a793ccc2e7f39360df20ee3f323e3fb8d">CIC_CALLS</a></div><div class="ttdeci">int CIC_CALLS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00009">cic.cu:9</a></div></div>
<div class="ttc" id="acic_8cu_html_ac76179fff32b3529b4a5d73452d35b9d"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#ac76179fff32b3529b4a5d73452d35b9d">CIC_KERNEL_TIME</a></div><div class="ttdeci">CPUTimer_t CIC_KERNEL_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00008">cic.cu:8</a></div></div>
<div class="ttc" id="acic_8cu_html_adc0dd2818da8e0af8703197df0746abe"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#adc0dd2818da8e0af8703197df0746abe">CICKernel</a></div><div class="ttdeci">__global__ void CICKernel(deviceFFT_t *__restrict grid, const float4 *__restrict my_pos, int ng, float mass)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00090">cic.cu:90</a></div></div>
<div class="ttc" id="acic_8cu_html_ae55de4065f3d7f164bf46a83f62a5591"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#ae55de4065f3d7f164bf46a83f62a5591">CIC_TIME</a></div><div class="ttdeci">CPUTimer_t CIC_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00007">cic.cu:7</a></div></div>
<div class="ttc" id="ahaccgpm_8hpp_html_a27d89e2a5f98ab524846b9bac59ebf44"><div class="ttname"><a href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a></div><div class="ttdeci">#define deviceFFT_t</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00021">haccgpm.hpp:21</a></div></div>
<div class="ttc" id="ahaccgpm_8hpp_html_a28fb452217abf040d6df7890f94a54b9"><div class="ttname"><a href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a></div><div class="ttdeci">#define cudaCall(func,...)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00037">haccgpm.hpp:37</a></div></div>
<div class="ttc" id="ahaccgpm_8hpp_html_a426f47de81eb03392ad93bb0e34433b2"><div class="ttname"><a href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a></div><div class="ttdeci">#define InvokeGPUKernel(func, numBlocks, blockSize,...)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00039">haccgpm.hpp:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dce/cic_8cu_source.html#l00009">CIC_CALLS</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00008">CIC_KERNEL_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00007">CIC_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00090">CICKernel()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00037">cudaCall</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00021">deviceFFT_t</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, and <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d33/power_8cu_source.html#l00299">GetPowerSpectrum()</a>, and <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_ac8b4ba312818288e4c808753bc322702_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_ac8b4ba312818288e4c808753bc322702_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_ac8b4ba312818288e4c808753bc322702_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_ac8b4ba312818288e4c808753bc322702_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,168,56"/>
<area shape="rect" href="../../d6/dce/cic_8cu.html#adc0dd2818da8e0af8703197df0746abe" title=" " alt="" coords="217,5,299,31"/>
<area shape="poly" title=" " alt="" coords="168,29,203,23,203,29,169,34"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="216,55,300,80"/>
<area shape="poly" title=" " alt="" coords="169,52,203,57,202,62,168,57"/>
</map>
</div>

</div>
</div>
<a id="a61abf058f64a8c48cb425ba0aa3cd3d8" name="a61abf058f64a8c48cb425ba0aa3cd3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61abf058f64a8c48cb425ba0aa3cd3d8">&#9670;&#160;</a></span>fft_cache_plan()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::fft_cache_plan </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00075">75</a> of file <a class="el" href="../../d2/df9/ffts_8cu_source.html">ffts.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>                                        {</div>
<div class="line"><span class="lineno">   76</span><span class="preprocessor">    #ifdef UsePlanManager</span></div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a97f9c40ffced254ea51e0a9e561d6cc3">plan_manager</a>.<a class="code hl_function" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0">get_plan</a>(ng,0);</div>
<div class="line"><span class="lineno">   78</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   79</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00046">PlanManager::get_plan()</a>, and <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00072">plan_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a61abf058f64a8c48cb425ba0aa3cd3d8_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a61abf058f64a8c48cb425ba0aa3cd3d8_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a61abf058f64a8c48cb425ba0aa3cd3d8_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a61abf058f64a8c48cb425ba0aa3cd3d8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,156,45"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="204,13,359,38"/>
<area shape="poly" title=" " alt="" coords="157,23,190,23,190,28,157,28"/>
</map>
</div>

</div>
</div>
<a id="a33ccdffdab832aa754528e05d4255b7c" name="a33ccdffdab832aa754528e05d4255b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33ccdffdab832aa754528e05d4255b7c">&#9670;&#160;</a></span>forward_fft() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::forward_fft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00081">81</a> of file <a class="el" href="../../d2/df9/ffts_8cu_source.html">ffts.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>                                                                                     {</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span><span class="preprocessor">    #ifdef VerboseFFT</span></div>
<div class="line"><span class="lineno">   88</span>    printf(<span class="stringliteral">&quot;%sforward_fft (out of place) was called with\n%s   ng %d\n&quot;</span>,indent,indent,ng);</div>
<div class="line"><span class="lineno">   89</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    cufftHandle plan;</div>
<div class="line"><span class="lineno">   92</span><span class="preprocessor">    #ifdef UsePlanManager</span></div>
<div class="line"><span class="lineno">   93</span>    plan = <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a97f9c40ffced254ea51e0a9e561d6cc3">plan_manager</a>.<a class="code hl_function" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0">get_plan</a>(ng,calls+1);</div>
<div class="line"><span class="lineno">   94</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">   95</span>    printf(<span class="stringliteral">&quot;%s   Creating plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span> (cufftPlan3d(&amp;plan, ng, ng, ng, CUFFT_Z2Z) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">   97</span>        printf(<span class="stringliteral">&quot;CUFFT error: Plan creation failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">   98</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   99</span>    };</div>
<div class="line"><span class="lineno">  100</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_t = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    printf(<span class="stringliteral">&quot;%s   Executing Z2Z CUFFT_FORWARD\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span> (cufftExecZ2Z(plan, data, out, CUFFT_FORWARD) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  106</span>        printf(<span class="stringliteral">&quot;CUFFT error: ExecZ2Z Forward failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  107</span>        <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno">  108</span>    }</div>
<div class="line"><span class="lineno">  109</span>    cudaDeviceSynchronize();</div>
<div class="line"><span class="lineno">  110</span><span class="preprocessor">    #ifndef UsePlanManager</span></div>
<div class="line"><span class="lineno">  111</span>    printf(<span class="stringliteral">&quot;%s   Destroying plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  112</span>    cufftDestroy(plan);</div>
<div class="line"><span class="lineno">  113</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_time = plan_t - start;</div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  118</span>    printf(<span class="stringliteral">&quot;%s   forward_fft (out of place) took %llu us (%llu us planning)\n&quot;</span>,indent,t,plan_time);</div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa16da18a1ce7d66eb3986ee36e5ba13c">FFT_FORWARD_CALLS_OP</a>++;</div>
<div class="line"><span class="lineno">  120</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a73b0960c7294781038ba3495b112fd88">FFT_FORWARD_TIME_OP</a> += t;</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c7274816b57443342cb2180b0d0fcdf">FFT_FORWARD_PLAN_TIME_OP</a> += plan_time;</div>
<div class="line"><span class="lineno">  122</span>}</div>
<div class="ttc" id="affts_8cu_html_a5c7274816b57443342cb2180b0d0fcdf"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a5c7274816b57443342cb2180b0d0fcdf">FFT_FORWARD_PLAN_TIME_OP</a></div><div class="ttdeci">CPUTimer_t FFT_FORWARD_PLAN_TIME_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00016">ffts.cu:16</a></div></div>
<div class="ttc" id="affts_8cu_html_a73b0960c7294781038ba3495b112fd88"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a73b0960c7294781038ba3495b112fd88">FFT_FORWARD_TIME_OP</a></div><div class="ttdeci">CPUTimer_t FFT_FORWARD_TIME_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00015">ffts.cu:15</a></div></div>
<div class="ttc" id="affts_8cu_html_aa16da18a1ce7d66eb3986ee36e5ba13c"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#aa16da18a1ce7d66eb3986ee36e5ba13c">FFT_FORWARD_CALLS_OP</a></div><div class="ttdeci">int FFT_FORWARD_CALLS_OP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00021">ffts.cu:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00021">FFT_FORWARD_CALLS_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00016">FFT_FORWARD_PLAN_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00015">FFT_FORWARD_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00046">PlanManager::get_plan()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, and <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00072">plan_manager</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00195">GenerateFourierAmplitudes()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00299">GetPowerSpectrum()</a>, <a class="el" href="../../d8/d93/solver_8cu_source.html#l00071">Solve()</a>, and <a class="el" href="../../d8/d93/solver_8cu_source.html#l00096">SolveGradient()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a33ccdffdab832aa754528e05d4255b7c_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a33ccdffdab832aa754528e05d4255b7c_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a33ccdffdab832aa754528e05d4255b7c_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a33ccdffdab832aa754528e05d4255b7c_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,205,56"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="289,5,373,31"/>
<area shape="poly" title=" " alt="" coords="205,29,275,22,275,27,206,35"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="253,55,408,80"/>
<area shape="poly" title=" " alt="" coords="206,51,240,55,239,60,205,57"/>
</map>
</div>

</div>
</div>
<a id="af7528d9faa62dea23e52934a46ff118b" name="af7528d9faa62dea23e52934a46ff118b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7528d9faa62dea23e52934a46ff118b">&#9670;&#160;</a></span>forward_fft() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::forward_fft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00124">124</a> of file <a class="el" href="../../d2/df9/ffts_8cu_source.html">ffts.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  124</span>                                                                   {</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span><span class="preprocessor">    #ifdef VerboseFFT</span></div>
<div class="line"><span class="lineno">  131</span>    printf(<span class="stringliteral">&quot;%sforward_fft (in place) was called with\n%s   ng %d\n&quot;</span>,indent,indent,ng);</div>
<div class="line"><span class="lineno">  132</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    cufftHandle plan;</div>
<div class="line"><span class="lineno">  135</span><span class="preprocessor">    #ifdef UsePlanManager</span></div>
<div class="line"><span class="lineno">  136</span>    plan = <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a97f9c40ffced254ea51e0a9e561d6cc3">plan_manager</a>.<a class="code hl_function" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0">get_plan</a>(ng,calls+1);</div>
<div class="line"><span class="lineno">  137</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno">  138</span>    printf(<span class="stringliteral">&quot;%s   Creating plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  139</span>    <span class="keywordflow">if</span> (cufftPlan3d(&amp;plan, ng, ng, ng, CUFFT_Z2Z) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  140</span>        printf(<span class="stringliteral">&quot;CUFFT error: Plan creation failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  142</span>    };</div>
<div class="line"><span class="lineno">  143</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  144</span>    </div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_t = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    printf(<span class="stringliteral">&quot;%s   Executing Z2Z CUFFT_FORWARD\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">if</span> (cufftExecZ2Z(plan, data, data, CUFFT_FORWARD) != CUFFT_SUCCESS){</div>
<div class="line"><span class="lineno">  149</span>        printf(<span class="stringliteral">&quot;CUFFT error: ExecZ2Z Forward failed\n&quot;</span>);</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno">  151</span>    }</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    cudaDeviceSynchronize();</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span><span class="preprocessor">    #ifndef UsePlanManager</span></div>
<div class="line"><span class="lineno">  156</span>    printf(<span class="stringliteral">&quot;%s   Destroying plan %d\n&quot;</span>,indent,ng);</div>
<div class="line"><span class="lineno">  157</span>    cufftDestroy(plan);</div>
<div class="line"><span class="lineno">  158</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> plan_time = plan_t - start;</div>
<div class="line"><span class="lineno">  162</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  163</span>    printf(<span class="stringliteral">&quot;%s   forward_fft (in place) took %llu us (%llu us planning)\n&quot;</span>,indent,t,plan_time);</div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa049ca4fe761e92b46f43d144719da51">FFT_FORWARD_CALLS_IP</a>++;</div>
<div class="line"><span class="lineno">  165</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#ad058f1087a0625fdb00d6c80435e42ca">FFT_FORWARD_TIME_IP</a> += t;</div>
<div class="line"><span class="lineno">  166</span>    <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a1c2a69653ddb2e1ef97d0fe4e9263584">FFT_FORWARD_PLAN_TIME_IP</a> += plan_time;</div>
<div class="line"><span class="lineno">  167</span>}</div>
<div class="ttc" id="affts_8cu_html_a1c2a69653ddb2e1ef97d0fe4e9263584"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#a1c2a69653ddb2e1ef97d0fe4e9263584">FFT_FORWARD_PLAN_TIME_IP</a></div><div class="ttdeci">CPUTimer_t FFT_FORWARD_PLAN_TIME_IP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00012">ffts.cu:12</a></div></div>
<div class="ttc" id="affts_8cu_html_aa049ca4fe761e92b46f43d144719da51"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#aa049ca4fe761e92b46f43d144719da51">FFT_FORWARD_CALLS_IP</a></div><div class="ttdeci">int FFT_FORWARD_CALLS_IP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00020">ffts.cu:20</a></div></div>
<div class="ttc" id="affts_8cu_html_ad058f1087a0625fdb00d6c80435e42ca"><div class="ttname"><a href="../../d2/df9/ffts_8cu.html#ad058f1087a0625fdb00d6c80435e42ca">FFT_FORWARD_TIME_IP</a></div><div class="ttdeci">CPUTimer_t FFT_FORWARD_TIME_IP</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00011">ffts.cu:11</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00020">FFT_FORWARD_CALLS_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00012">FFT_FORWARD_PLAN_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00011">FFT_FORWARD_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00046">PlanManager::get_plan()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, and <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00072">plan_manager</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_af7528d9faa62dea23e52934a46ff118b_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_af7528d9faa62dea23e52934a46ff118b_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_af7528d9faa62dea23e52934a46ff118b_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_af7528d9faa62dea23e52934a46ff118b_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,205,56"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="289,5,373,31"/>
<area shape="poly" title=" " alt="" coords="205,29,275,22,275,27,206,35"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="253,55,408,80"/>
<area shape="poly" title=" " alt="" coords="206,51,240,55,239,60,205,57"/>
</map>
</div>

</div>
</div>
<a id="a4fae33fb8958064c643b8fe76740ee0a" name="a4fae33fb8958064c643b8fe76740ee0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fae33fb8958064c643b8fe76740ee0a">&#9670;&#160;</a></span>GenerateDisplacementIC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::GenerateDisplacementIC </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>params_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html">HACCGPM::serial::MemoryManager</a> *&#160;</td>
          <td class="paramname"><em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fscal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00267">267</a> of file <a class="el" href="../../de/d3b/initializer_8cu_source.html">initializer.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  267</span>                                                                                                                                                                                                {</div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  272</span>    printf(<span class="stringliteral">&quot;%sGenerateDisplacementIC was called with\n%s   blockSize %d\n%s   numBlocks %d\n%s   params %s\n&quot;</span>,indent,indent,blockSize,indent,numBlocks,indent,params_file);</div>
<div class="line"><span class="lineno">  273</span>    printf(<span class="stringliteral">&quot;%s   Calling GenerateFourierAmplitudes...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  274</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>    <a class="code hl_function" href="../../de/d3b/initializer_8cu.html#a6a1e1c9afd370c22b87be6000710c79d">GenerateFourierAmplitudes</a>(params_file, mem-&gt;<a class="code hl_variable" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#abbd431066638877a310bff815c23ea9a">d_grid</a>, ng, rl, z, seed, blockSize, calls+1);</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  279</span>    printf(<span class="stringliteral">&quot;%s      Called GenerateFourierAmplitudes.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  280</span>    printf(<span class="stringliteral">&quot;%s   Allocating d_sx, d_sy, d_sz...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  281</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>* d_sx; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_sx,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  284</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>* d_sy; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_sy,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>* d_sz; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_sz,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  288</span>    printf(<span class="stringliteral">&quot;%s      Allocated d_sx, d_sy, d_sz.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  289</span>    printf(<span class="stringliteral">&quot;%s   Calling get_delta_and_dotDelta...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  290</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordtype">double</span> delta;</div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordtype">double</span> dotDelta;</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordtype">double</span> this_a = (1/(z + 1)) - (deltaT/2.0f);</div>
<div class="line"><span class="lineno">  295</span>    <span class="keywordtype">double</span> velZ = (1.0f/this_a) - 1.0f;</div>
<div class="line"><span class="lineno">  296</span>    <a class="code hl_function" href="../../d1/dc2/ccamb_8c.html#ac0e00d8b9c96e56e190e4c04d30fb237">get_delta_and_dotDelta</a>(params_file, z,velZ,&amp;delta,&amp;dotDelta,calls+1);</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>    printf(<span class="stringliteral">&quot;%s      Delta %g, dotDelta %g\n&quot;</span>,indent,delta,dotDelta);</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="comment">//finalize_python(calls+1);</span></div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  303</span>    printf(<span class="stringliteral">&quot;%s      Called get_delta_and_dotDelta.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  304</span>    printf(<span class="stringliteral">&quot;%s   Calling transformDensityField...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  305</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../de/d3b/initializer_8cu.html#ac29241f3695227eb88a70b902a8b3cdb">transformDensityField</a>,numBlocks,blockSize,mem-&gt;<a class="code hl_variable" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#abbd431066638877a310bff815c23ea9a">d_grid</a>,d_sx,d_sy,d_sz,delta,rl,1/(1+z),ng);</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  310</span>    printf(<span class="stringliteral">&quot;%s      Called transformVelocityField.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  311</span>    printf(<span class="stringliteral">&quot;%s   Doing Backward FFTs...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  312</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_sx,ng,calls+1);</div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_sy,ng,calls+1);</div>
<div class="line"><span class="lineno">  316</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_sz,ng,calls+1);</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordtype">double</span> scale_by = 1.0f/((double)(ng*ng*ng));</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../de/d3b/initializer_8cu.html#a0ff351b62d308a913e30708b2ce6952e">ScaleFFT</a>,numBlocks,blockSize,d_sx,scale_by);</div>
<div class="line"><span class="lineno">  321</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../de/d3b/initializer_8cu.html#a0ff351b62d308a913e30708b2ce6952e">ScaleFFT</a>,numBlocks,blockSize,d_sy,scale_by);</div>
<div class="line"><span class="lineno">  322</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../de/d3b/initializer_8cu.html#a0ff351b62d308a913e30708b2ce6952e">ScaleFFT</a>,numBlocks,blockSize,d_sz,scale_by);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  325</span>    printf(<span class="stringliteral">&quot;%s      Done Backward FFTs.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  326</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../de/d3b/initializer_8cu.html#a2fe476c02dd57a3bf0adeed08604e935">placeParticles</a>,numBlocks,blockSize,mem-&gt;<a class="code hl_variable" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#ace6d685f78c900863a38d60c6c006086">d_pos</a>,mem-&gt;<a class="code hl_variable" href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#a52c5749138fe8cf456ec75bb6b442bd3">d_vel</a>,d_sx,d_sy,d_sz,delta,dotDelta,rl,1/(1+z),deltaT,fscal,ng);</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  331</span>    printf(<span class="stringliteral">&quot;%s   Freeing d_sx, d_sy, d_sz...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  332</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    cudaFree(d_sx);</div>
<div class="line"><span class="lineno">  335</span>    cudaFree(d_sy);</div>
<div class="line"><span class="lineno">  336</span>    cudaFree(d_sz);</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span><span class="preprocessor">    #ifdef VerboseInitializer</span></div>
<div class="line"><span class="lineno">  339</span>    printf(<span class="stringliteral">&quot;%s      Freed d_sx, d_sy, d_sz.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  341</span>}</div>
<div class="ttc" id="accamb_8c_html_ac0e00d8b9c96e56e190e4c04d30fb237"><div class="ttname"><a href="../../d1/dc2/ccamb_8c.html#ac0e00d8b9c96e56e190e4c04d30fb237">get_delta_and_dotDelta</a></div><div class="ttdeci">void get_delta_and_dotDelta(const char *params_file, double z, double z1, double *delta, double *dotDelta, int calls)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dc2/ccamb_8c_source.html#l00332">ccamb.c:332</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1serial_1_1MemoryManager_html_a52c5749138fe8cf456ec75bb6b442bd3"><div class="ttname"><a href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#a52c5749138fe8cf456ec75bb6b442bd3">HACCGPM::serial::MemoryManager::d_vel</a></div><div class="ttdeci">float4 * d_vel</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00207">haccgpm.hpp:207</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1serial_1_1MemoryManager_html_abbd431066638877a310bff815c23ea9a"><div class="ttname"><a href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#abbd431066638877a310bff815c23ea9a">HACCGPM::serial::MemoryManager::d_grid</a></div><div class="ttdeci">deviceFFT_t * d_grid</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00210">haccgpm.hpp:210</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1serial_1_1MemoryManager_html_ace6d685f78c900863a38d60c6c006086"><div class="ttname"><a href="../../d0/d2c/classHACCGPM_1_1serial_1_1MemoryManager.html#ace6d685f78c900863a38d60c6c006086">HACCGPM::serial::MemoryManager::d_pos</a></div><div class="ttdeci">float4 * d_pos</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00206">haccgpm.hpp:206</a></div></div>
<div class="ttc" id="ainitializer_8cu_html_a0ff351b62d308a913e30708b2ce6952e"><div class="ttname"><a href="../../de/d3b/initializer_8cu.html#a0ff351b62d308a913e30708b2ce6952e">ScaleFFT</a></div><div class="ttdeci">__global__ void ScaleFFT(deviceFFT_t *__restrict data, double scale)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d3b/initializer_8cu_source.html#l00046">initializer.cu:46</a></div></div>
<div class="ttc" id="ainitializer_8cu_html_a2fe476c02dd57a3bf0adeed08604e935"><div class="ttname"><a href="../../de/d3b/initializer_8cu.html#a2fe476c02dd57a3bf0adeed08604e935">placeParticles</a></div><div class="ttdeci">__global__ void placeParticles(float4 *__restrict d_pos, float4 *__restrict d_vel, deviceFFT_t *__restrict outSx, deviceFFT_t *__restrict outSy, deviceFFT_t *__restrict outSz, double delta, double dotDelta, double rl, double a, double deltaT, double fscal, int ng)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d3b/initializer_8cu_source.html#l00137">initializer.cu:137</a></div></div>
<div class="ttc" id="ainitializer_8cu_html_a6a1e1c9afd370c22b87be6000710c79d"><div class="ttname"><a href="../../de/d3b/initializer_8cu.html#a6a1e1c9afd370c22b87be6000710c79d">GenerateFourierAmplitudes</a></div><div class="ttdeci">void GenerateFourierAmplitudes(const char *params_file, deviceFFT_t *d_grid1, int ng, double rl, double z, int seed, int blockSize, int calls)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d3b/initializer_8cu_source.html#l00195">initializer.cu:195</a></div></div>
<div class="ttc" id="ainitializer_8cu_html_ac29241f3695227eb88a70b902a8b3cdb"><div class="ttname"><a href="../../de/d3b/initializer_8cu.html#ac29241f3695227eb88a70b902a8b3cdb">transformDensityField</a></div><div class="ttdeci">__global__ void transformDensityField(const deviceFFT_t *__restrict oldGrid, deviceFFT_t *__restrict outSx, deviceFFT_t *__restrict outSy, deviceFFT_t *__restrict outSz, double delta, double rl, double a, int ng)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d3b/initializer_8cu_source.html#l00059">initializer.cu:59</a></div></div>
<div class="ttc" id="anamespaceHACCGPM_1_1serial_html_af8d988b0ca5106d342dc9591708ff789"><div class="ttname"><a href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a></div><div class="ttdeci">void backward_fft(deviceFFT_t *data, deviceFFT_t *out, int ng, int calls=0)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00169">ffts.cu:169</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00169">backward_fft()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00037">cudaCall</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00210">HACCGPM::serial::MemoryManager::d_grid</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00206">HACCGPM::serial::MemoryManager::d_pos</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00207">HACCGPM::serial::MemoryManager::d_vel</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00021">deviceFFT_t</a>, <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00195">GenerateFourierAmplitudes()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00332">get_delta_and_dotDelta()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>, <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00137">placeParticles()</a>, <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00046">ScaleFFT()</a>, and <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00059">transformDensityField()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a4fae33fb8958064c643b8fe76740ee0a_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a4fae33fb8958064c643b8fe76740ee0a_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a4fae33fb8958064c643b8fe76740ee0a_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a4fae33fb8958064c643b8fe76740ee0a_cgraph">
<area shape="rect" title=" " alt="" coords="5,229,196,269"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789" title=" " alt="" coords="472,5,685,31"/>
<area shape="poly" title=" " alt="" coords="123,227,177,186,243,142,353,83,471,39,498,32,500,37,473,45,356,88,245,147,180,190,127,231"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#a6a1e1c9afd370c22b87be6000710c79d" title=" " alt="" coords="244,157,424,183"/>
<area shape="poly" title=" " alt="" coords="155,226,243,195,278,184,280,189,245,201,157,231"/>
<area shape="rect" href="../../d1/dc2/ccamb_8c.html#ac0e00d8b9c96e56e190e4c04d30fb237" title=" " alt="" coords="255,211,413,236"/>
<area shape="poly" title=" " alt="" coords="196,236,241,231,241,236,197,241"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#a2fe476c02dd57a3bf0adeed08604e935" title=" " alt="" coords="282,260,386,285"/>
<area shape="poly" title=" " alt="" coords="197,256,268,263,268,269,196,261"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#a0ff351b62d308a913e30708b2ce6952e" title=" " alt="" coords="295,359,373,384"/>
<area shape="poly" title=" " alt="" coords="127,267,179,306,245,344,282,357,280,362,243,348,176,310,123,271"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#ac29241f3695227eb88a70b902a8b3cdb" title=" " alt="" coords="259,309,409,335"/>
<area shape="poly" title=" " alt="" coords="159,266,245,294,275,303,273,308,243,299,158,271"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="769,55,853,80"/>
<area shape="poly" title=" " alt="" coords="639,28,755,53,754,58,638,33"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="733,153,888,179"/>
<area shape="poly" title=" " alt="" coords="660,28,687,40,703,51,713,62,735,90,789,142,785,146,731,93,709,66,699,55,684,44,658,33"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c" title=" " alt="" coords="479,252,679,277"/>
<area shape="poly" title=" " alt="" coords="389,180,425,196,440,206,450,217,459,227,473,237,493,245,491,250,471,242,456,231,446,221,437,210,423,200,387,185"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#a3a6a489ebcb9da12e9b3f57b08ac6396" title=" " alt="" coords="503,55,654,80"/>
<area shape="poly" title=" " alt="" coords="351,155,403,122,471,89,494,81,496,86,473,94,406,127,354,159"/>
<area shape="rect" href="../../d1/dc2/ccamb_8c.html#a5240afbdd580b5513f35a20c42e2c7e4" title=" " alt="" coords="548,104,609,129"/>
<area shape="poly" title=" " alt="" coords="392,155,534,124,535,129,393,160"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#a174a7dfb28cda0d682d3532053a673af" title=" " alt="" coords="544,153,613,179"/>
<area shape="poly" title=" " alt="" coords="424,166,530,164,530,169,424,171"/>
<area shape="rect" href="../../de/d3b/initializer_8cu.html#a5886c0bfc1e8bc6577b1f33c8e24cd5b" title=" " alt="" coords="519,203,639,228"/>
<area shape="poly" title=" " alt="" coords="403,180,505,199,504,204,402,185"/>
<area shape="poly" title=" " alt="" coords="663,250,684,237,703,215,710,193,717,167,731,139,756,111,781,87,785,91,760,115,736,142,722,169,715,194,707,218,687,241,665,254"/>
<area shape="poly" title=" " alt="" coords="645,249,684,237,736,211,780,184,783,188,739,216,686,242,646,255"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ad9fb99027bd0e8c4666c28a5b85d419e" title=" " alt="" coords="501,302,657,342"/>
<area shape="poly" title=" " alt="" coords="387,281,487,301,486,306,386,286"/>
<area shape="poly" title=" " alt="" coords="409,319,487,319,487,325,409,325"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#adebf563a2ff1ace956181e3a26ea6cb2" title=" " alt="" coords="501,366,657,406"/>
<area shape="poly" title=" " alt="" coords="384,332,490,360,488,365,382,337"/>
</map>
</div>

</div>
</div>
<a id="ae31040d68a45a644d5e079616e99061c" name="ae31040d68a45a644d5e079616e99061c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae31040d68a45a644d5e079616e99061c">&#9670;&#160;</a></span>get_adot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double HACCGPM::serial::get_adot </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_aa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_wa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_omega_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_omega_radiation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_f_nu_massless</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_f_nu_massive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_omega_matter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_omega_nu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00011">11</a> of file <a class="el" href="../../d4/d48/timestepper_8cu_source.html">timestepper.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   11</span>                                                                                                                                                                                                        {</div>
<div class="line"><span class="lineno">   12</span>    <span class="keywordtype">double</span> pp1 = pow(m_aa, -3.0*(m_w+m_wa))*exp(-3.0*m_wa*(1.0-m_aa));</div>
<div class="line"><span class="lineno">   13</span>    <span class="keywordtype">double</span> tmp = m_omega_cb</div>
<div class="line"><span class="lineno">   14</span>    + (1.0+m_f_nu_massless)*m_omega_radiation/m_aa</div>
<div class="line"><span class="lineno">   15</span>    + <a class="code hl_function" href="../../d4/d48/timestepper_8cu.html#aa212987f3df0db02b305c7bf57dba992">omega_nu_massive</a>(m_aa,m_omega_nu,m_f_nu_massive,m_omega_radiation)*pow(m_aa,3.0)</div>
<div class="line"><span class="lineno">   16</span>    + (1.0-m_omega_matter-(1.0+m_f_nu_massless)*m_omega_radiation)*pp1;</div>
<div class="line"><span class="lineno">   17</span>    tmp /= m_aa;</div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordflow">return</span> sqrt(tmp);</div>
<div class="line"><span class="lineno">   19</span>}</div>
<div class="ttc" id="atimestepper_8cu_html_aa212987f3df0db02b305c7bf57dba992"><div class="ttname"><a href="../../d4/d48/timestepper_8cu.html#aa212987f3df0db02b305c7bf57dba992">omega_nu_massive</a></div><div class="ttdeci">double omega_nu_massive(double a, double m_omega_nu, double m_f_nu_massive, double m_omega_radiation)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d48/timestepper_8cu_source.html#l00005">timestepper.cu:5</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00005">omega_nu_massive()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00050">HACCGPM::Timestepper::advanceHalfStep()</a>, <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00058">HACCGPM::Timestepper::reverseHalfStep()</a>, <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00035">HACCGPM::Timestepper::setInitialA()</a>, and <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00042">HACCGPM::Timestepper::setInitialZ()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_ae31040d68a45a644d5e079616e99061c_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_ae31040d68a45a644d5e079616e99061c_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_ae31040d68a45a644d5e079616e99061c_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_ae31040d68a45a644d5e079616e99061c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,193,31"/>
<area shape="rect" href="../../d4/d48/timestepper_8cu.html#aa212987f3df0db02b305c7bf57dba992" title=" " alt="" coords="241,5,380,31"/>
<area shape="poly" title=" " alt="" coords="194,15,227,15,227,21,194,21"/>
</map>
</div>

</div>
</div>
<a id="ab791cb661ee56bd0e61992d605b9dd80" name="ab791cb661ee56bd0e61992d605b9dd80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab791cb661ee56bd0e61992d605b9dd80">&#9670;&#160;</a></span>get_fscal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double HACCGPM::serial::get_fscal </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_aa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_adot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m_omega_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00021">21</a> of file <a class="el" href="../../d4/d48/timestepper_8cu_source.html">timestepper.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   21</span>                                                                            {</div>
<div class="line"><span class="lineno">   22</span>    <span class="keywordtype">float</span> dtdy = m_aa/(m_aa*m_adot);</div>
<div class="line"><span class="lineno">   23</span>    <span class="keywordtype">double</span> m_phiscal = 1.5*m_omega_cb;<span class="comment">//Poisson equation is grad^2 phi = 3/2 omega_m (rho-1)</span></div>
<div class="line"><span class="lineno">   24</span>    <span class="keywordtype">double</span> m_fscal = m_phiscal*dtdy*(1.0/m_aa);</div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordflow">return</span> m_fscal;</div>
<div class="line"><span class="lineno">   26</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00050">HACCGPM::Timestepper::advanceHalfStep()</a>, <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00058">HACCGPM::Timestepper::reverseHalfStep()</a>, <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00035">HACCGPM::Timestepper::setInitialA()</a>, and <a class="el" href="../../d4/d48/timestepper_8cu_source.html#l00042">HACCGPM::Timestepper::setInitialZ()</a>.</p>

</div>
</div>
<a id="ad9fb99027bd0e8c4666c28a5b85d419e" name="ad9fb99027bd0e8c4666c28a5b85d419e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9fb99027bd0e8c4666c28a5b85d419e">&#9670;&#160;</a></span>get_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ __forceinline__ int3 HACCGPM::serial::get_index </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00217">217</a> of file <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html">haccgpm.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  217</span>                                                                  {</div>
<div class="line"><span class="lineno">  218</span>            int3 out;</div>
<div class="line"><span class="lineno">  219</span>            out.x = idx/(ng*ng);</div>
<div class="line"><span class="lineno">  220</span>            out.y = (idx - (out.x*ng*ng))/ng;</div>
<div class="line"><span class="lineno">  221</span>            out.z = (idx - (out.x*ng*ng)) - out.y*ng;</div>
<div class="line"><span class="lineno">  222</span>            <span class="keywordflow">return</span> out;</div>
<div class="line"><span class="lineno">  223</span>        }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d0/d33/power_8cu_source.html#l00167">BinPower()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00141">BinPower()</a>, <a class="el" href="../../d4/d77/greens_8cu_source.html#l00034">getGreens()</a>, <a class="el" href="../../d8/d93/solver_8cu_source.html#l00021">kspace_solve_gradient()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00066">PkCICFilter()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00031">PkCICFilter()</a>, <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00137">placeParticles()</a>, and <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00059">transformDensityField()</a>.</p>

</div>
</div>
<a id="adebf563a2ff1ace956181e3a26ea6cb2" name="adebf563a2ff1ace956181e3a26ea6cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adebf563a2ff1ace956181e3a26ea6cb2">&#9670;&#160;</a></span>get_kmodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ __forceinline__ float3 HACCGPM::serial::get_kmodes </td>
          <td>(</td>
          <td class="paramtype">int3&#160;</td>
          <td class="paramname"><em>idx3d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00225">225</a> of file <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html">haccgpm.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>                                                                                  {</div>
<div class="line"><span class="lineno">  226</span>            <span class="keywordtype">float</span> l = idx3d.x;</div>
<div class="line"><span class="lineno">  227</span>            <span class="keywordflow">if</span> (idx3d.x &gt; ((ng/2)-1)){</div>
<div class="line"><span class="lineno">  228</span>                l = -(ng - idx3d.x);</div>
<div class="line"><span class="lineno">  229</span>            }</div>
<div class="line"><span class="lineno">  230</span>            l *= d;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>            <span class="keywordtype">float</span> m = idx3d.y;</div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">if</span> (idx3d.y &gt; ((ng/2)-1)){</div>
<div class="line"><span class="lineno">  234</span>                m = -(ng - idx3d.y);</div>
<div class="line"><span class="lineno">  235</span>            }</div>
<div class="line"><span class="lineno">  236</span>            m *= d;</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordtype">float</span> n = idx3d.z;</div>
<div class="line"><span class="lineno">  239</span>            <span class="keywordflow">if</span> (idx3d.z &gt; ((ng/2)-1)){</div>
<div class="line"><span class="lineno">  240</span>                n = -(ng - idx3d.z);</div>
<div class="line"><span class="lineno">  241</span>            }</div>
<div class="line"><span class="lineno">  242</span>            n *= d;</div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">return</span> make_float3(l,m,n);</div>
<div class="line"><span class="lineno">  244</span>        }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d0/d33/power_8cu_source.html#l00167">BinPower()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00141">BinPower()</a>, <a class="el" href="../../d4/d77/greens_8cu_source.html#l00034">getGreens()</a>, <a class="el" href="../../d8/d93/solver_8cu_source.html#l00021">kspace_solve_gradient()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00066">PkCICFilter()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00031">PkCICFilter()</a>, and <a class="el" href="../../de/d3b/initializer_8cu_source.html#l00059">transformDensityField()</a>.</p>

</div>
</div>
<a id="a2c364758c8fc90a0a3d8ac62168c2e4c" name="a2c364758c8fc90a0a3d8ac62168c2e4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c364758c8fc90a0a3d8ac62168c2e4c">&#9670;&#160;</a></span>GetFinerPowerSpectrum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::GetFinerPowerSpectrum </td>
          <td>(</td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_temp_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fftNg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa89c1764f5268d9a5780657b7a25f780" name="aa89c1764f5268d9a5780657b7a25f780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89c1764f5268d9a5780657b7a25f780">&#9670;&#160;</a></span>GetPowerSpectrum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::GetPowerSpectrum </td>
          <td>(</td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nbins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfolds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d33/power_8cu_source.html#l00299">299</a> of file <a class="el" href="../../d0/d33/power_8cu_source.html">power.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  299</span>                                                                                                                                                             {</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">  304</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  305</span><span class="preprocessor">    #ifdef VerbosePower</span></div>
<div class="line"><span class="lineno">  306</span>    printf(<span class="stringliteral">&quot;%sGetPowerSpectrum was called with\n%s   blockSize %d\n%s   numBlocks %d\n&quot;</span>,indent,indent,blockSize,indent,numBlocks);</div>
<div class="line"><span class="lineno">  307</span>    printf(<span class="stringliteral">&quot;%s   Allocating d_temp_pos, kBins, binCounts, binVals, d_binCounts, d_binVals\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  308</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    float4* d_temp_pos; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_temp_pos,<span class="keyword">sizeof</span>(float4)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  311</span>    <span class="comment">//hostFFT_t* d_powerSpectrum; cudaCall(cudaMalloc,&amp;d_powerSpectrum,sizeof(hostFFT_t)*ng*ng*ng);</span></div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordtype">double</span>* kBins = (<span class="keywordtype">double</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*nbins);</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordtype">int</span>* binCounts = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(nbins));</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordtype">double</span>* binVals = (<span class="keywordtype">double</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*nbins);</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordtype">int</span>* d_binCounts; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_binCounts,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*nbins);</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordtype">double</span>* d_binVals; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_binVals,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*nbins);</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    <span class="comment">//hostFFT_t* tmp = (hostFFT_t*)malloc(sizeof(hostFFT_t)*ng*ng*ng);</span></div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>    <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d0/d33/power_8cu.html#abb06d3288ef0b39c8812e8cb8d6c3cc7">cpy</a>,numBlocks,blockSize,d_temp_pos,d_pos);</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordtype">double</span> new_rl = (rl/(pow(2,nfolds)));</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordtype">double</span> d = (2*M_PI)/(new_rl);</div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordtype">double</span> d3 = sqrt(3*d*d);</div>
<div class="line"><span class="lineno">  328</span>    </div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordtype">double</span> minK = d;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordtype">double</span> maxK = sqrt(3*((ng/2)*(ng/2)*d*d));</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <span class="keywordtype">double</span> binDelta = (maxK - minK)/((<span class="keywordtype">double</span>)nbins);</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbins; i++){</div>
<div class="line"><span class="lineno">  336</span>        kBins[i] = minK + binDelta * (((float)i) + 0.5f);</div>
<div class="line"><span class="lineno">  337</span>    }</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    new_rl = rl;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> current_fold = 0; current_fold &lt; nfolds + 1; current_fold++){</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>        <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemset,d_binCounts,0,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*nbins);</div>
<div class="line"><span class="lineno">  344</span>        <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemset,d_binVals,0,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*nbins);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>        new_rl = (rl/(pow(2,current_fold)));</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>        d = (2*M_PI)/(new_rl);</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>        <span class="keywordflow">if</span> (current_fold &gt; 0){</div>
<div class="line"><span class="lineno">  351</span>            <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d0/d33/power_8cu.html#a987c68ca36b003c733161e4039f3a7f5">foldParticles</a>,numBlocks,blockSize,d_temp_pos,(<span class="keywordtype">double</span>)ng);</div>
<div class="line"><span class="lineno">  352</span>        }</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>        <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start_extras = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>        <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ac8b4ba312818288e4c808753bc322702">HACCGPM::serial::CIC</a>(d_grid,d_temp_pos,ng,blockSize,calls+1);</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>        <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c">HACCGPM::serial::forward_fft</a>(d_grid,ng,calls + 1);</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>        <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end_extras = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a> += end_extras - start_extras;</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d0/d33/power_8cu.html#a1f629b32d30e906a43f7bc9d31a95aba">scalePower</a>,numBlocks,blockSize,d_grid,(<span class="keywordtype">double</span>)ng,rl);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>        <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d0/d33/power_8cu.html#a37872452600d46f9503dcc360a48adcb">PkCICFilter</a>,numBlocks,blockSize,d_grid,ng,current_fold);</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>        <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d0/d33/power_8cu.html#ad6d8985f8d4e557aed24d2c7ed1b18cd">BinPower</a>,numBlocks,blockSize,d_grid,d_binVals,d_binCounts,minK,binDelta,new_rl,ng);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>        <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemcpy, binVals, d_binVals, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*nbins, cudaMemcpyDeviceToHost);</div>
<div class="line"><span class="lineno">  371</span>        <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemcpy, binCounts, d_binCounts, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*nbins, cudaMemcpyDeviceToHost);</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>        <span class="keywordtype">char</span> fname2[400];</div>
<div class="line"><span class="lineno">  374</span>        sprintf(fname2, <span class="stringliteral">&quot;%s.fold.%d&quot;</span>, fname, current_fold);</div>
<div class="line"><span class="lineno">  375</span>        FILE *fp;</div>
<div class="line"><span class="lineno">  376</span>        fp = fopen(fname2, <span class="stringliteral">&quot;w+&quot;</span>);</div>
<div class="line"><span class="lineno">  377</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbins; i++){</div>
<div class="line"><span class="lineno">  378</span>            <span class="keywordtype">double</span> out = binVals[i]/((double)binCounts[i]);</div>
<div class="line"><span class="lineno">  379</span>            <span class="keywordflow">if</span> ((out == out) &amp;&amp; (binCounts[i] != 0) &amp;&amp; (out != 0)){</div>
<div class="line"><span class="lineno">  380</span>                fprintf(fp,<span class="stringliteral">&quot;%g,%g,%d\n&quot;</span>,kBins[i],out,binCounts[i]);</div>
<div class="line"><span class="lineno">  381</span>            }</div>
<div class="line"><span class="lineno">  382</span>            binVals[i] = 0;</div>
<div class="line"><span class="lineno">  383</span>            binCounts[i] = 0;</div>
<div class="line"><span class="lineno">  384</span>        }</div>
<div class="line"><span class="lineno">  385</span>        fclose(fp);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    }</div>
<div class="line"><span class="lineno">  388</span>    free(kBins);</div>
<div class="line"><span class="lineno">  389</span>    free(binCounts);</div>
<div class="line"><span class="lineno">  390</span>    free(binVals);</div>
<div class="line"><span class="lineno">  391</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaFree,d_temp_pos);</div>
<div class="line"><span class="lineno">  392</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaFree,d_binCounts);</div>
<div class="line"><span class="lineno">  393</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaFree,d_binVals);</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  398</span>    <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a698a61c0af0367d6c71a2a74ac868385">POWER_CALLS</a>++;</div>
<div class="line"><span class="lineno">  399</span>    <a class="code hl_variable" href="../../d0/d33/power_8cu.html#ae785a8ef144f17d04541e43d2b9a492b">POWER_TIME</a> += t;</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>    printf(<span class="stringliteral">&quot;%s   GetPowerSpectrum took %llu us\n&quot;</span>,indent,t);</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>}</div>
<div class="ttc" id="anamespaceHACCGPM_1_1serial_html_a33ccdffdab832aa754528e05d4255b7c"><div class="ttname"><a href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c">HACCGPM::serial::forward_fft</a></div><div class="ttdeci">void forward_fft(deviceFFT_t *data, deviceFFT_t *out, int ng, int calls=0)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df9/ffts_8cu_source.html#l00081">ffts.cu:81</a></div></div>
<div class="ttc" id="anamespaceHACCGPM_1_1serial_html_ac8b4ba312818288e4c808753bc322702"><div class="ttname"><a href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ac8b4ba312818288e4c808753bc322702">HACCGPM::serial::CIC</a></div><div class="ttdeci">void CIC(deviceFFT_t *d_grid, float4 *d_pos, int ng, int blockSize, int calls=0)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00198">cic.cu:198</a></div></div>
<div class="ttc" id="apower_8cu_html_a1f629b32d30e906a43f7bc9d31a95aba"><div class="ttname"><a href="../../d0/d33/power_8cu.html#a1f629b32d30e906a43f7bc9d31a95aba">scalePower</a></div><div class="ttdeci">__global__ void scalePower(const deviceFFT_t *__restrict data, hostFFT_t *__restrict out, double ng, double rl)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00011">power.cu:11</a></div></div>
<div class="ttc" id="apower_8cu_html_a37872452600d46f9503dcc360a48adcb"><div class="ttname"><a href="../../d0/d33/power_8cu.html#a37872452600d46f9503dcc360a48adcb">PkCICFilter</a></div><div class="ttdeci">__global__ void PkCICFilter(double *__restrict grid, int ng, int folds)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00031">power.cu:31</a></div></div>
<div class="ttc" id="apower_8cu_html_a698a61c0af0367d6c71a2a74ac868385"><div class="ttname"><a href="../../d0/d33/power_8cu.html#a698a61c0af0367d6c71a2a74ac868385">POWER_CALLS</a></div><div class="ttdeci">int POWER_CALLS</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00008">power.cu:8</a></div></div>
<div class="ttc" id="apower_8cu_html_a987c68ca36b003c733161e4039f3a7f5"><div class="ttname"><a href="../../d0/d33/power_8cu.html#a987c68ca36b003c733161e4039f3a7f5">foldParticles</a></div><div class="ttdeci">__global__ void foldParticles(float4 *__restrict d_pos, double ng)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00101">power.cu:101</a></div></div>
<div class="ttc" id="apower_8cu_html_a9983828558c24178d51fa790ae409275"><div class="ttname"><a href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a></div><div class="ttdeci">CPUTimer_t POWER_KERNEL_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00009">power.cu:9</a></div></div>
<div class="ttc" id="apower_8cu_html_abb06d3288ef0b39c8812e8cb8d6c3cc7"><div class="ttname"><a href="../../d0/d33/power_8cu.html#abb06d3288ef0b39c8812e8cb8d6c3cc7">cpy</a></div><div class="ttdeci">__global__ void cpy(float4 *__restrict dest, const float4 *__restrict source)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00135">power.cu:135</a></div></div>
<div class="ttc" id="apower_8cu_html_ad6d8985f8d4e557aed24d2c7ed1b18cd"><div class="ttname"><a href="../../d0/d33/power_8cu.html#ad6d8985f8d4e557aed24d2c7ed1b18cd">BinPower</a></div><div class="ttdeci">__global__ void BinPower(const hostFFT_t *__restrict d_powerSpectrum, double *__restrict d_binVals, int *__restrict d_binCounts, double minK, double binDelta, double rl, int ng)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00141">power.cu:141</a></div></div>
<div class="ttc" id="apower_8cu_html_ae785a8ef144f17d04541e43d2b9a492b"><div class="ttname"><a href="../../d0/d33/power_8cu.html#ae785a8ef144f17d04541e43d2b9a492b">POWER_TIME</a></div><div class="ttdeci">CPUTimer_t POWER_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d33/power_8cu_source.html#l00007">power.cu:7</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/d33/power_8cu_source.html#l00141">BinPower()</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00198">CIC()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00135">cpy()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00037">cudaCall</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00101">foldParticles()</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00081">forward_fft()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00031">PkCICFilter()</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00008">POWER_CALLS</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00009">POWER_KERNEL_TIME</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00007">POWER_TIME</a>, and <a class="el" href="../../d0/d33/power_8cu_source.html#l00011">scalePower()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_aa89c1764f5268d9a5780657b7a25f780_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_aa89c1764f5268d9a5780657b7a25f780_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_aa89c1764f5268d9a5780657b7a25f780_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_aa89c1764f5268d9a5780657b7a25f780_cgraph">
<area shape="rect" title=" " alt="" coords="5,200,201,240"/>
<area shape="rect" href="../../d0/d33/power_8cu.html#ad6d8985f8d4e557aed24d2c7ed1b18cd" title=" " alt="" coords="310,30,389,55"/>
<area shape="poly" title=" " alt="" coords="115,198,168,132,205,95,248,64,271,54,296,47,297,52,273,59,251,69,209,99,171,135,119,201"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ac8b4ba312818288e4c808753bc322702" title=" " alt="" coords="268,131,431,157"/>
<area shape="poly" title=" " alt="" coords="168,197,294,158,296,163,169,202"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="533,183,617,209"/>
<area shape="poly" title=" " alt="" coords="202,212,519,196,520,201,202,218"/>
<area shape="rect" href="../../d0/d33/power_8cu.html#abb06d3288ef0b39c8812e8cb8d6c3cc7" title=" " alt="" coords="328,282,371,307"/>
<area shape="poly" title=" " alt="" coords="158,238,250,268,315,285,314,290,249,273,156,243"/>
<area shape="rect" href="../../d0/d33/power_8cu.html#a987c68ca36b003c733161e4039f3a7f5" title=" " alt="" coords="302,331,397,357"/>
<area shape="poly" title=" " alt="" coords="129,238,182,279,250,318,290,331,288,336,248,322,179,283,125,242"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c" title=" " alt="" coords="249,233,449,258"/>
<area shape="poly" title=" " alt="" coords="202,227,236,231,236,236,201,233"/>
<area shape="rect" href="../../d0/d33/power_8cu.html#a37872452600d46f9503dcc360a48adcb" title=" " alt="" coords="304,79,395,105"/>
<area shape="poly" title=" " alt="" coords="125,197,180,157,248,116,290,101,292,106,250,121,183,161,129,202"/>
<area shape="rect" href="../../d0/d33/power_8cu.html#a1f629b32d30e906a43f7bc9d31a95aba" title=" " alt="" coords="304,381,395,406"/>
<area shape="poly" title=" " alt="" coords="119,239,172,303,209,338,251,367,291,382,289,387,248,372,206,342,168,306,115,242"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ad9fb99027bd0e8c4666c28a5b85d419e" title=" " alt="" coords="497,69,653,109"/>
<area shape="poly" title=" " alt="" coords="389,48,485,68,484,73,388,53"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#adebf563a2ff1ace956181e3a26ea6cb2" title=" " alt="" coords="497,5,653,45"/>
<area shape="poly" title=" " alt="" coords="388,37,483,30,484,35,389,42"/>
<area shape="rect" href="../../d6/dce/cic_8cu.html#adc0dd2818da8e0af8703197df0746abe" title=" " alt="" coords="534,134,617,159"/>
<area shape="poly" title=" " alt="" coords="431,142,520,143,520,149,431,148"/>
<area shape="poly" title=" " alt="" coords="405,154,520,181,519,186,404,159"/>
<area shape="poly" title=" " alt="" coords="407,230,519,205,521,211,408,235"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="498,233,653,258"/>
<area shape="poly" title=" " alt="" coords="450,243,484,243,484,248,450,248"/>
<area shape="poly" title=" " alt="" coords="395,89,484,88,484,93,395,94"/>
<area shape="poly" title=" " alt="" coords="394,79,449,64,503,47,505,52,450,69,395,84"/>
</map>
</div>

</div>
</div>
<a id="aba96f26caa0971a861e23d251bdca488" name="aba96f26caa0971a861e23d251bdca488"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba96f26caa0971a861e23d251bdca488">&#9670;&#160;</a></span>InitGreens()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::InitGreens </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a2f67acc29a084b658dd371975fb27bd8">hostFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_greens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d77/greens_8cu_source.html#l00061">61</a> of file <a class="el" href="../../d4/d77/greens_8cu_source.html">greens.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>                                                                                   {</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span><span class="preprocessor">    #ifdef VerboseGreens</span></div>
<div class="line"><span class="lineno">   68</span>    printf(<span class="stringliteral">&quot;%sInitGreens was called with\n%s   blockSize %d\n%s   numBlocks %d\n&quot;</span>,indent,indent,blockSize,indent,numBlocks);</div>
<div class="line"><span class="lineno">   69</span>    printf(<span class="stringliteral">&quot;%s   Calling getGreens...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   70</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d4/d77/greens_8cu.html#ac57b5d2e3828609345a4862eb07de73d">getGreens</a>,numBlocks,blockSize,d_greens,ng);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span><span class="preprocessor">    #ifdef VerboseGreens</span></div>
<div class="line"><span class="lineno">   75</span>    printf(<span class="stringliteral">&quot;%s      Called getGreens...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   76</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>}</div>
<div class="ttc" id="agreens_8cu_html_ac57b5d2e3828609345a4862eb07de73d"><div class="ttname"><a href="../../d4/d77/greens_8cu.html#ac57b5d2e3828609345a4862eb07de73d">getGreens</a></div><div class="ttdeci">__global__ void getGreens(hostFFT_t *__restrict d_greens, int ng)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d77/greens_8cu_source.html#l00034">greens.cu:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d77/greens_8cu_source.html#l00034">getGreens()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, and <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_aba96f26caa0971a861e23d251bdca488_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_aba96f26caa0971a861e23d251bdca488_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_aba96f26caa0971a861e23d251bdca488_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_aba96f26caa0971a861e23d251bdca488_cgraph">
<area shape="rect" title=" " alt="" coords="5,87,204,112"/>
<area shape="rect" href="../../d4/d77/greens_8cu.html#ac57b5d2e3828609345a4862eb07de73d" title=" " alt="" coords="252,87,335,112"/>
<area shape="poly" title=" " alt="" coords="205,97,238,97,238,102,205,102"/>
<area shape="rect" href="../../d4/d77/greens_8cu.html#a433f2f14e1f68ea413b287f57dfb019c" title=" " alt="" coords="439,29,482,55"/>
<area shape="poly" title=" " alt="" coords="327,84,382,65,425,50,427,55,384,70,329,89"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ad9fb99027bd0e8c4666c28a5b85d419e" title=" " alt="" coords="383,79,539,119"/>
<area shape="poly" title=" " alt="" coords="335,97,369,97,369,102,335,102"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#adebf563a2ff1ace956181e3a26ea6cb2" title=" " alt="" coords="383,143,539,183"/>
<area shape="poly" title=" " alt="" coords="328,110,396,136,394,141,326,115"/>
<area shape="poly" title=" " alt="" coords="437,34,428,24,429,13,440,5,461,3,487,8,493,14,494,21,489,22,488,17,484,13,461,8,442,10,434,16,433,22,441,30"/>
</map>
</div>

</div>
</div>
<a id="a873c8a9f36dff354099861a9cc5a7da2" name="a873c8a9f36dff354099861a9cc5a7da2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a873c8a9f36dff354099861a9cc5a7da2">&#9670;&#160;</a></span>printCICTimes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::printCICTimes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dce/cic_8cu_source.html#l00245">245</a> of file <a class="el" href="../../d6/dce/cic_8cu_source.html">cic.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span>                                 {</div>
<div class="line"><span class="lineno">  246</span>    printf(<span class="stringliteral">&quot;   CIC               -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a793ccc2e7f39360df20ee3f323e3fb8d">CIC_CALLS</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ae55de4065f3d7f164bf46a83f62a5591">CIC_TIME</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ae55de4065f3d7f164bf46a83f62a5591">CIC_TIME</a> - <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ac76179fff32b3529b4a5d73452d35b9d">CIC_KERNEL_TIME</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ac76179fff32b3529b4a5d73452d35b9d">CIC_KERNEL_TIME</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#ae55de4065f3d7f164bf46a83f62a5591">CIC_TIME</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a793ccc2e7f39360df20ee3f323e3fb8d">CIC_CALLS</a>)));</div>
<div class="line"><span class="lineno">  247</span>    printf(<span class="stringliteral">&quot;   UpdatePositions   -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#adb634614133df6486708eadd96bf0789">UPDATE_POS_CALLS</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a10cfa3709ad8e4a997626cd8ee6f63dc">UPDATE_POS_TIME</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a10cfa3709ad8e4a997626cd8ee6f63dc">UPDATE_POS_TIME</a> - <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#adab57b6c7fb75fc6c88cece7a3de0baa">UPDATE_POS_KERNEL_TIME</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#adab57b6c7fb75fc6c88cece7a3de0baa">UPDATE_POS_KERNEL_TIME</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a10cfa3709ad8e4a997626cd8ee6f63dc">UPDATE_POS_TIME</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#adb634614133df6486708eadd96bf0789">UPDATE_POS_CALLS</a>)));</div>
<div class="line"><span class="lineno">  248</span>    printf(<span class="stringliteral">&quot;   UpdateVelocities  -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a75f88d15f42ff6a8d6da001a58c08093">UPDATE_VEL_CALLS</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a0286a91f200b88746649daf40cc0dab5">UPDATE_VEL_TIME</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a0286a91f200b88746649daf40cc0dab5">UPDATE_VEL_TIME</a> - <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a12c2adcc2ffa6bc49dfff4a7f1cddf68">UPDATE_VEL_KERNEL_TIME</a>,<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a12c2adcc2ffa6bc49dfff4a7f1cddf68">UPDATE_VEL_KERNEL_TIME</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a0286a91f200b88746649daf40cc0dab5">UPDATE_VEL_TIME</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a75f88d15f42ff6a8d6da001a58c08093">UPDATE_VEL_CALLS</a>)));</div>
<div class="line"><span class="lineno">  249</span>}</div>
<div class="ttc" id="acic_8cu_html_a0286a91f200b88746649daf40cc0dab5"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#a0286a91f200b88746649daf40cc0dab5">UPDATE_VEL_TIME</a></div><div class="ttdeci">CPUTimer_t UPDATE_VEL_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00015">cic.cu:15</a></div></div>
<div class="ttc" id="acic_8cu_html_a10cfa3709ad8e4a997626cd8ee6f63dc"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#a10cfa3709ad8e4a997626cd8ee6f63dc">UPDATE_POS_TIME</a></div><div class="ttdeci">CPUTimer_t UPDATE_POS_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00011">cic.cu:11</a></div></div>
<div class="ttc" id="acic_8cu_html_a12c2adcc2ffa6bc49dfff4a7f1cddf68"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#a12c2adcc2ffa6bc49dfff4a7f1cddf68">UPDATE_VEL_KERNEL_TIME</a></div><div class="ttdeci">CPUTimer_t UPDATE_VEL_KERNEL_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00016">cic.cu:16</a></div></div>
<div class="ttc" id="acic_8cu_html_a75f88d15f42ff6a8d6da001a58c08093"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#a75f88d15f42ff6a8d6da001a58c08093">UPDATE_VEL_CALLS</a></div><div class="ttdeci">int UPDATE_VEL_CALLS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00017">cic.cu:17</a></div></div>
<div class="ttc" id="acic_8cu_html_adab57b6c7fb75fc6c88cece7a3de0baa"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#adab57b6c7fb75fc6c88cece7a3de0baa">UPDATE_POS_KERNEL_TIME</a></div><div class="ttdeci">CPUTimer_t UPDATE_POS_KERNEL_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00012">cic.cu:12</a></div></div>
<div class="ttc" id="acic_8cu_html_adb634614133df6486708eadd96bf0789"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#adb634614133df6486708eadd96bf0789">UPDATE_POS_CALLS</a></div><div class="ttdeci">int UPDATE_POS_CALLS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00013">cic.cu:13</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d6/dce/cic_8cu_source.html#l00009">CIC_CALLS</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00008">CIC_KERNEL_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00007">CIC_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00013">UPDATE_POS_CALLS</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00012">UPDATE_POS_KERNEL_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00011">UPDATE_POS_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00017">UPDATE_VEL_CALLS</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00016">UPDATE_VEL_KERNEL_TIME</a>, and <a class="el" href="../../d6/dce/cic_8cu_source.html#l00015">UPDATE_VEL_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>

</div>
</div>
<a id="a1e499b679db21f46e02946401a4ed44f" name="a1e499b679db21f46e02946401a4ed44f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e499b679db21f46e02946401a4ed44f">&#9670;&#160;</a></span>printFFTTimes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::printFFTTimes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00253">253</a> of file <a class="el" href="../../d2/df9/ffts_8cu_source.html">ffts.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  253</span>                                 {</div>
<div class="line"><span class="lineno">  254</span>    <span class="comment">//printf(&quot;   CIC              -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;,CIC_CALLS,CIC_TIME,CIC_TIME - CIC_KERNEL_TIME,CIC_KERNEL_TIME,((float)CIC_TIME)/((float)(CIC_CALLS)));</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="comment">//printf(&quot;   UpdatePositions  -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;,UPDATE_POS_CALLS,UPDATE_POS_TIME,UPDATE_POS_TIME - UPDATE_POS_KERNEL_TIME,UPDATE_POS_KERNEL_TIME,((float)UPDATE_POS_TIME)/((float)(UPDATE_POS_CALLS)));</span></div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa16da18a1ce7d66eb3986ee36e5ba13c">FFT_FORWARD_CALLS_OP</a> != 0){</div>
<div class="line"><span class="lineno">  257</span>        printf(<span class="stringliteral">&quot;   forward_fft (op)  -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa16da18a1ce7d66eb3986ee36e5ba13c">FFT_FORWARD_CALLS_OP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a73b0960c7294781038ba3495b112fd88">FFT_FORWARD_TIME_OP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c7274816b57443342cb2180b0d0fcdf">FFT_FORWARD_PLAN_TIME_OP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a73b0960c7294781038ba3495b112fd88">FFT_FORWARD_TIME_OP</a> - <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c7274816b57443342cb2180b0d0fcdf">FFT_FORWARD_PLAN_TIME_OP</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a73b0960c7294781038ba3495b112fd88">FFT_FORWARD_TIME_OP</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa16da18a1ce7d66eb3986ee36e5ba13c">FFT_FORWARD_CALLS_OP</a>)));</div>
<div class="line"><span class="lineno">  258</span>    }</div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa049ca4fe761e92b46f43d144719da51">FFT_FORWARD_CALLS_IP</a> != 0){</div>
<div class="line"><span class="lineno">  260</span>        printf(<span class="stringliteral">&quot;   forward_fft (ip)  -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa049ca4fe761e92b46f43d144719da51">FFT_FORWARD_CALLS_IP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#ad058f1087a0625fdb00d6c80435e42ca">FFT_FORWARD_TIME_IP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a1c2a69653ddb2e1ef97d0fe4e9263584">FFT_FORWARD_PLAN_TIME_IP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#ad058f1087a0625fdb00d6c80435e42ca">FFT_FORWARD_TIME_IP</a> - <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a1c2a69653ddb2e1ef97d0fe4e9263584">FFT_FORWARD_PLAN_TIME_IP</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#ad058f1087a0625fdb00d6c80435e42ca">FFT_FORWARD_TIME_IP</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#aa049ca4fe761e92b46f43d144719da51">FFT_FORWARD_CALLS_IP</a>)));</div>
<div class="line"><span class="lineno">  261</span>    }</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10c41d1c7b046f472f0865cbc2f6f1d1">FFT_BACKWARD_CALLS_OP</a> != 0){</div>
<div class="line"><span class="lineno">  263</span>        printf(<span class="stringliteral">&quot;   backward_fft (op) -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10c41d1c7b046f472f0865cbc2f6f1d1">FFT_BACKWARD_CALLS_OP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10b151b803e5dc48583ce4c1323e844b">FFT_BACKWARD_TIME_OP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a71619cec016a53624323fd9c63fadf8c">FFT_BACKWARD_PLAN_TIME_OP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10b151b803e5dc48583ce4c1323e844b">FFT_BACKWARD_TIME_OP</a> - <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a71619cec016a53624323fd9c63fadf8c">FFT_BACKWARD_PLAN_TIME_OP</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10b151b803e5dc48583ce4c1323e844b">FFT_BACKWARD_TIME_OP</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a10c41d1c7b046f472f0865cbc2f6f1d1">FFT_BACKWARD_CALLS_OP</a>)));</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a8e917450629fec0bba13fe3ed19f9f3d">FFT_BACKWARD_CALLS_IP</a> != 0){</div>
<div class="line"><span class="lineno">  266</span>        printf(<span class="stringliteral">&quot;   backward_fft (ip) -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a8e917450629fec0bba13fe3ed19f9f3d">FFT_BACKWARD_CALLS_IP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c4af52d5f4a3d0d6497a788251a28e7">FFT_BACKWARD_TIME_IP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a0a1088ef396eb179693acf3bcaf20059">FFT_BACKWARD_PLAN_TIME_IP</a>,<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c4af52d5f4a3d0d6497a788251a28e7">FFT_BACKWARD_TIME_IP</a> - <a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a0a1088ef396eb179693acf3bcaf20059">FFT_BACKWARD_PLAN_TIME_IP</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a5c4af52d5f4a3d0d6497a788251a28e7">FFT_BACKWARD_TIME_IP</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d2/df9/ffts_8cu.html#a8e917450629fec0bba13fe3ed19f9f3d">FFT_BACKWARD_CALLS_IP</a>)));</div>
<div class="line"><span class="lineno">  267</span>    }</div>
<div class="line"><span class="lineno">  268</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00022">FFT_BACKWARD_CALLS_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00023">FFT_BACKWARD_CALLS_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00014">FFT_BACKWARD_PLAN_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00018">FFT_BACKWARD_PLAN_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00013">FFT_BACKWARD_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00017">FFT_BACKWARD_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00020">FFT_FORWARD_CALLS_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00021">FFT_FORWARD_CALLS_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00012">FFT_FORWARD_PLAN_TIME_IP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00016">FFT_FORWARD_PLAN_TIME_OP</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00011">FFT_FORWARD_TIME_IP</a>, and <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00015">FFT_FORWARD_TIME_OP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>

</div>
</div>
<a id="a7e7cdba1605fe8248b3f1306667c5d5c" name="a7e7cdba1605fe8248b3f1306667c5d5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e7cdba1605fe8248b3f1306667c5d5c">&#9670;&#160;</a></span>printOutputTimes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::printOutputTimes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d85/io_8cu_source.html#l00041">41</a> of file <a class="el" href="../../dd/d85/io_8cu_source.html">io.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>                                    {</div>
<div class="line"><span class="lineno">   42</span>    printf(<span class="stringliteral">&quot;   writeOutput       -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10d us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../dd/d85/io_8cu.html#a7c1af194f729e11f1fc192111adb21ff">OUTPUT_CALLS</a>,<a class="code hl_variable" href="../../dd/d85/io_8cu.html#a35c720fada5b8c3ff17c1ba734476094">OUTPUT_TIME</a>,<a class="code hl_variable" href="../../dd/d85/io_8cu.html#a35c720fada5b8c3ff17c1ba734476094">OUTPUT_TIME</a>,0,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../dd/d85/io_8cu.html#a35c720fada5b8c3ff17c1ba734476094">OUTPUT_TIME</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../dd/d85/io_8cu.html#a7c1af194f729e11f1fc192111adb21ff">OUTPUT_CALLS</a>)));</div>
<div class="line"><span class="lineno">   43</span>}</div>
<div class="ttc" id="aio_8cu_html_a35c720fada5b8c3ff17c1ba734476094"><div class="ttname"><a href="../../dd/d85/io_8cu.html#a35c720fada5b8c3ff17c1ba734476094">OUTPUT_TIME</a></div><div class="ttdeci">CPUTimer_t OUTPUT_TIME</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d85/io_8cu_source.html#l00005">io.cu:5</a></div></div>
<div class="ttc" id="aio_8cu_html_a7c1af194f729e11f1fc192111adb21ff"><div class="ttname"><a href="../../dd/d85/io_8cu.html#a7c1af194f729e11f1fc192111adb21ff">OUTPUT_CALLS</a></div><div class="ttdeci">int OUTPUT_CALLS</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d85/io_8cu_source.html#l00006">io.cu:6</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dd/d85/io_8cu_source.html#l00006">OUTPUT_CALLS</a>, and <a class="el" href="../../dd/d85/io_8cu_source.html#l00005">OUTPUT_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>

</div>
</div>
<a id="a233115e291533b87d96cc0baeadc74cd" name="a233115e291533b87d96cc0baeadc74cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a233115e291533b87d96cc0baeadc74cd">&#9670;&#160;</a></span>printPowerTimes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::printPowerTimes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d33/power_8cu_source.html#l00405">405</a> of file <a class="el" href="../../d0/d33/power_8cu_source.html">power.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  405</span>                                   {</div>
<div class="line"><span class="lineno">  406</span>    printf(<span class="stringliteral">&quot;   GetPowerSpectrum  -&gt; calls: %10d | total: %10llu us | cpu: %10llu us | gpu: %10llu us | mean: %10.2f us\n&quot;</span>,<a class="code hl_variable" href="../../d0/d33/power_8cu.html#a698a61c0af0367d6c71a2a74ac868385">POWER_CALLS</a>,<a class="code hl_variable" href="../../d0/d33/power_8cu.html#ae785a8ef144f17d04541e43d2b9a492b">POWER_TIME</a>,<a class="code hl_variable" href="../../d0/d33/power_8cu.html#ae785a8ef144f17d04541e43d2b9a492b">POWER_TIME</a> - <a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a>,<a class="code hl_variable" href="../../d0/d33/power_8cu.html#a9983828558c24178d51fa790ae409275">POWER_KERNEL_TIME</a>,((<span class="keywordtype">float</span>)<a class="code hl_variable" href="../../d0/d33/power_8cu.html#ae785a8ef144f17d04541e43d2b9a492b">POWER_TIME</a>)/((<span class="keywordtype">float</span>)(<a class="code hl_variable" href="../../d0/d33/power_8cu.html#a698a61c0af0367d6c71a2a74ac868385">POWER_CALLS</a>)));</div>
<div class="line"><span class="lineno">  407</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d0/d33/power_8cu_source.html#l00008">POWER_CALLS</a>, <a class="el" href="../../d0/d33/power_8cu_source.html#l00009">POWER_KERNEL_TIME</a>, and <a class="el" href="../../d0/d33/power_8cu_source.html#l00007">POWER_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>

</div>
</div>
<a id="a3ad482d1daabaede6890859e0934d75a" name="a3ad482d1daabaede6890859e0934d75a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ad482d1daabaede6890859e0934d75a">&#9670;&#160;</a></span>Solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::Solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a2f67acc29a084b658dd371975fb27bd8">hostFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_greens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d93/solver_8cu_source.html#l00071">71</a> of file <a class="el" href="../../d8/d93/solver_8cu_source.html">solver.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   71</span>                                                                                                  {</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">   77</span>    printf(<span class="stringliteral">&quot;%sSolve was called with\n%s   blockSize %d\n%s   numBlocks %d\n&quot;</span>,indent,indent,blockSize,indent,numBlocks);</div>
<div class="line"><span class="lineno">   78</span>    printf(<span class="stringliteral">&quot;%s   Doing forward fft...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   79</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c">HACCGPM::serial::forward_fft</a>(d_rho,ng,calls+1);</div>
<div class="line"><span class="lineno">   81</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">   82</span>    printf(<span class="stringliteral">&quot;%s      Done forward fft.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   83</span>    printf(<span class="stringliteral">&quot;%s   Calling kspace_solve...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   84</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d8/d93/solver_8cu.html#a2d3738cb7bfa385764cf2f74712ec4e7">kspace_solve</a>,numBlocks,blockSize,d_rho,d_greens);</div>
<div class="line"><span class="lineno">   86</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">   87</span>    printf(<span class="stringliteral">&quot;%s      Called kspace_solve.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   88</span>    printf(<span class="stringliteral">&quot;%s   Doing backward fft...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   89</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_rho,ng,calls+1);</div>
<div class="line"><span class="lineno">   91</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">   92</span>    printf(<span class="stringliteral">&quot;%s      Done backward fft.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   93</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">   94</span>}</div>
<div class="ttc" id="asolver_8cu_html_a2d3738cb7bfa385764cf2f74712ec4e7"><div class="ttname"><a href="../../d8/d93/solver_8cu.html#a2d3738cb7bfa385764cf2f74712ec4e7">kspace_solve</a></div><div class="ttdeci">__global__ void kspace_solve(deviceFFT_t *__restrict d_rho, const hostFFT_t *__restrict d_greens)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d93/solver_8cu_source.html#l00011">solver.cu:11</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00169">backward_fft()</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00081">forward_fft()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>, and <a class="el" href="../../d8/d93/solver_8cu_source.html#l00011">kspace_solve()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a3ad482d1daabaede6890859e0934d75a_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a3ad482d1daabaede6890859e0934d75a_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a3ad482d1daabaede6890859e0934d75a_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a3ad482d1daabaede6890859e0934d75a_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,176,80"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789" title=" " alt="" coords="224,55,437,80"/>
<area shape="poly" title=" " alt="" coords="176,65,210,65,210,70,176,70"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c" title=" " alt="" coords="231,5,431,31"/>
<area shape="poly" title=" " alt="" coords="152,52,255,31,256,36,153,57"/>
<area shape="rect" href="../../d8/d93/solver_8cu.html#a2d3738cb7bfa385764cf2f74712ec4e7" title=" " alt="" coords="279,104,382,129"/>
<area shape="poly" title=" " alt="" coords="153,77,267,101,266,106,152,83"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="521,5,605,31"/>
<area shape="poly" title=" " alt="" coords="390,52,506,27,507,32,391,57"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="485,55,640,80"/>
<area shape="poly" title=" " alt="" coords="437,65,472,65,472,70,437,70"/>
<area shape="poly" title=" " alt="" coords="431,15,507,15,507,21,431,21"/>
<area shape="poly" title=" " alt="" coords="391,28,490,49,489,54,390,33"/>
</map>
</div>

</div>
</div>
<a id="aa38be02d5fae626750b7f03b40a40dab" name="aa38be02d5fae626750b7f03b40a40dab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa38be02d5fae626750b7f03b40a40dab">&#9670;&#160;</a></span>SolveGradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::SolveGradient </td>
          <td>(</td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d0d/haccgpm_8hpp.html#a2f67acc29a084b658dd371975fb27bd8">hostFFT_t</a> *&#160;</td>
          <td class="paramname"><em>d_greens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d93/solver_8cu_source.html#l00096">96</a> of file <a class="el" href="../../d8/d93/solver_8cu_source.html">solver.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   96</span>                                                                                                                          {</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  102</span>    printf(<span class="stringliteral">&quot;%sSolveGradient was called with\n%s   blockSize %d\n%s   numBlocks %d\n&quot;</span>,indent,indent,blockSize,indent,numBlocks);</div>
<div class="line"><span class="lineno">  103</span>    printf(<span class="stringliteral">&quot;%s   Doing forward fft...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  104</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  105</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c">HACCGPM::serial::forward_fft</a>(d_rho,ng,calls+1);</div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  107</span>    printf(<span class="stringliteral">&quot;%s      Done forward fft.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  108</span>    printf(<span class="stringliteral">&quot;%s   Allocating d_x, d_y, d_z...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  109</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>* d_x; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_x,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>* d_y; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_y,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>* d_z; <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMalloc,&amp;d_z,<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a27d89e2a5f98ab524846b9bac59ebf44">deviceFFT_t</a>)*ng*ng*ng);</div>
<div class="line"><span class="lineno">  113</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  114</span>    printf(<span class="stringliteral">&quot;%s      Allocated d_x, d_y, d_z\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  115</span>    printf(<span class="stringliteral">&quot;%s   Calling kspace_solve_gradient...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  116</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordtype">double</span> <span class="keyword">const</span> b1 =   4.0 / 3.0;</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">double</span> <span class="keyword">const</span> b2 = - 1.0 / 6.0;</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d8/d93/solver_8cu.html#a9ea24b7850f2c4b5b57254179613fb3e">kspace_solve_gradient</a>,numBlocks,blockSize,d_x,d_y,d_z,d_rho,d_greens,b1,b2,ng);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  124</span>    printf(<span class="stringliteral">&quot;%s      Called kspace_solve_gradient.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  125</span>    printf(<span class="stringliteral">&quot;%s   Doing backward ffts...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  126</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_x,ng,calls+1);</div>
<div class="line"><span class="lineno">  129</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_y,ng,calls+1);</div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_function" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789">HACCGPM::serial::backward_fft</a>(d_z,ng,calls+1);</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="comment">//SHOULD WE NORMALIZE THIS???</span></div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  135</span>    printf(<span class="stringliteral">&quot;%s      Done backward ffts.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  136</span>    printf(<span class="stringliteral">&quot;%s   Calling combine...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  137</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d8/d93/solver_8cu.html#a71c3109fe66f9f1fcac25bd98c8f486d">combine</a>,numBlocks,blockSize,d_grad,d_x,d_y,d_z);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  142</span>    printf(<span class="stringliteral">&quot;%s      Called combine.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  143</span>    printf(<span class="stringliteral">&quot;%s   Freeing d_x, d_y, d_z...\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  144</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaFree,d_x);</div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaFree,d_y);</div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaFree,d_z);</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span><span class="preprocessor">    #ifdef VerboseSolver</span></div>
<div class="line"><span class="lineno">  151</span>    printf(<span class="stringliteral">&quot;%s      Freed d_x, d_y, d_z.\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">  152</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  153</span>}</div>
<div class="ttc" id="asolver_8cu_html_a71c3109fe66f9f1fcac25bd98c8f486d"><div class="ttname"><a href="../../d8/d93/solver_8cu.html#a71c3109fe66f9f1fcac25bd98c8f486d">combine</a></div><div class="ttdeci">__global__ void combine(float4 *__restrict out, const deviceFFT_t *__restrict d_x, const deviceFFT_t *__restrict d_y, const deviceFFT_t *__restrict d_z)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d93/solver_8cu_source.html#l00057">solver.cu:57</a></div></div>
<div class="ttc" id="asolver_8cu_html_a9ea24b7850f2c4b5b57254179613fb3e"><div class="ttname"><a href="../../d8/d93/solver_8cu.html#a9ea24b7850f2c4b5b57254179613fb3e">kspace_solve_gradient</a></div><div class="ttdeci">__global__ void kspace_solve_gradient(deviceFFT_t *__restrict d_x, deviceFFT_t *__restrict d_y, deviceFFT_t *__restrict d_z, const deviceFFT_t *__restrict d_rho, const hostFFT_t *__restrict d_greens, float b1, float b2, int ng)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d93/solver_8cu_source.html#l00021">solver.cu:21</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00169">backward_fft()</a>, <a class="el" href="../../d8/d93/solver_8cu_source.html#l00057">combine()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00037">cudaCall</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00021">deviceFFT_t</a>, <a class="el" href="../../d2/df9/ffts_8cu_source.html#l00081">forward_fft()</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>, and <a class="el" href="../../d8/d93/solver_8cu_source.html#l00021">kspace_solve_gradient()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_aa38be02d5fae626750b7f03b40a40dab_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_aa38be02d5fae626750b7f03b40a40dab_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_aa38be02d5fae626750b7f03b40a40dab_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_aa38be02d5fae626750b7f03b40a40dab_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,225,105"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#af8d988b0ca5106d342dc9591708ff789" title=" " alt="" coords="273,5,487,31"/>
<area shape="poly" title=" " alt="" coords="151,77,273,39,305,31,306,36,274,45,153,82"/>
<area shape="rect" href="../../d8/d93/solver_8cu.html#a71c3109fe66f9f1fcac25bd98c8f486d" title=" " alt="" coords="345,104,415,129"/>
<area shape="poly" title=" " alt="" coords="226,100,331,110,331,115,225,105"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#a33ccdffdab832aa754528e05d4255b7c" title=" " alt="" coords="280,55,480,80"/>
<area shape="poly" title=" " alt="" coords="225,79,266,76,267,81,226,85"/>
<area shape="rect" href="../../d8/d93/solver_8cu.html#a9ea24b7850f2c4b5b57254179613fb3e" title=" " alt="" coords="303,157,457,183"/>
<area shape="poly" title=" " alt="" coords="156,103,274,139,317,151,315,156,273,145,154,108"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="571,55,655,80"/>
<area shape="poly" title=" " alt="" coords="440,28,558,53,557,58,439,33"/>
<area shape="rect" href="../../d4/d83/classPlanManager.html#a42f7d34dc999efd9bb3d2665537101e0" title=" " alt="" coords="535,5,690,31"/>
<area shape="poly" title=" " alt="" coords="487,15,521,15,521,21,487,21"/>
<area shape="poly" title=" " alt="" coords="480,65,557,65,557,70,480,70"/>
<area shape="poly" title=" " alt="" coords="439,52,539,31,540,36,440,57"/>
<area shape="rect" href="../../d8/d93/solver_8cu.html#a1f0dcdf9546948280cdbc0f9a95fdb8a" title=" " alt="" coords="566,104,659,129"/>
<area shape="poly" title=" " alt="" coords="435,155,552,128,553,133,436,160"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#ad9fb99027bd0e8c4666c28a5b85d419e" title=" " alt="" coords="535,154,691,194"/>
<area shape="poly" title=" " alt="" coords="458,169,521,170,521,175,457,174"/>
<area shape="rect" href="../../d5/d07/namespaceHACCGPM_1_1serial.html#adebf563a2ff1ace956181e3a26ea6cb2" title=" " alt="" coords="535,218,691,258"/>
<area shape="poly" title=" " alt="" coords="425,180,532,212,530,217,423,185"/>
</map>
</div>

</div>
</div>
<a id="afc7b5439a4f273a0b5136c983988630c" name="afc7b5439a4f273a0b5136c983988630c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7b5439a4f273a0b5136c983988630c">&#9670;&#160;</a></span>UpdatePositions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::UpdatePositions </td>
          <td>(</td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/df0/classHACCGPM_1_1Timestepper.html">HACCGPM::Timestepper</a>&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dce/cic_8cu_source.html#l00229">229</a> of file <a class="el" href="../../d6/dce/cic_8cu_source.html">cic.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  229</span>                                                                                                                                    {</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordtype">float</span> prefactor = ((ts.<a class="code hl_variable" href="../../db/df0/classHACCGPM_1_1Timestepper.html#adfdf31cff6181c0620faede8a70baa5b">deltaT</a>)/(ts.<a class="code hl_variable" href="../../db/df0/classHACCGPM_1_1Timestepper.html#aa27100376a4cba8759eb071259df0174">aa</a> * ts.<a class="code hl_variable" href="../../db/df0/classHACCGPM_1_1Timestepper.html#aa27100376a4cba8759eb071259df0174">aa</a> * ts.<a class="code hl_variable" href="../../db/df0/classHACCGPM_1_1Timestepper.html#a86c7011d1168ac217c82747ce8624fca">adot</a>)) * frac;</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  234</span><span class="preprocessor">    #ifdef VerboseUpdate</span></div>
<div class="line"><span class="lineno">  235</span>    printf(<span class="stringliteral">&quot;%sUpdate Positions was called with\n%s   blockSize %d\n%s   numBlocks %d\n%s   frac %g\n%s   prefactor %g\n&quot;</span>,indent,indent,blockSize,indent,numBlocks,indent,frac,indent,prefactor);</div>
<div class="line"><span class="lineno">  236</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  237</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#adab57b6c7fb75fc6c88cece7a3de0baa">UPDATE_POS_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d6/dce/cic_8cu.html#aa574c845e54a29eb9a143efa0ed493b2">UpdatePosKernel</a>,numBlocks,blockSize,d_pos,d_vel,prefactor,(<span class="keywordtype">float</span>)ng);</div>
<div class="line"><span class="lineno">  238</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  240</span>    printf(<span class="stringliteral">&quot;%s   UpdatePositions took %llu us\n&quot;</span>,indent,t);</div>
<div class="line"><span class="lineno">  241</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a10cfa3709ad8e4a997626cd8ee6f63dc">UPDATE_POS_TIME</a> += t;</div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#adb634614133df6486708eadd96bf0789">UPDATE_POS_CALLS</a> += 1;</div>
<div class="line"><span class="lineno">  243</span>}</div>
<div class="ttc" id="acic_8cu_html_aa574c845e54a29eb9a143efa0ed493b2"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#aa574c845e54a29eb9a143efa0ed493b2">UpdatePosKernel</a></div><div class="ttdeci">__global__ void UpdatePosKernel(float4 *__restrict d_pos, const float4 *__restrict d_vel, float prefactor, float ng)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00019">cic.cu:19</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1Timestepper_html_a86c7011d1168ac217c82747ce8624fca"><div class="ttname"><a href="../../db/df0/classHACCGPM_1_1Timestepper.html#a86c7011d1168ac217c82747ce8624fca">HACCGPM::Timestepper::adot</a></div><div class="ttdeci">double adot</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00105">haccgpm.hpp:105</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1Timestepper_html_aa27100376a4cba8759eb071259df0174"><div class="ttname"><a href="../../db/df0/classHACCGPM_1_1Timestepper.html#aa27100376a4cba8759eb071259df0174">HACCGPM::Timestepper::aa</a></div><div class="ttdeci">double aa</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00102">haccgpm.hpp:102</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1Timestepper_html_adfdf31cff6181c0620faede8a70baa5b"><div class="ttname"><a href="../../db/df0/classHACCGPM_1_1Timestepper.html#adfdf31cff6181c0620faede8a70baa5b">HACCGPM::Timestepper::deltaT</a></div><div class="ttdeci">double deltaT</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00104">haccgpm.hpp:104</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00102">HACCGPM::Timestepper::aa</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00105">HACCGPM::Timestepper::adot</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00104">HACCGPM::Timestepper::deltaT</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00013">UPDATE_POS_CALLS</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00012">UPDATE_POS_KERNEL_TIME</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00011">UPDATE_POS_TIME</a>, and <a class="el" href="../../d6/dce/cic_8cu_source.html#l00019">UpdatePosKernel()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_afc7b5439a4f273a0b5136c983988630c_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_afc7b5439a4f273a0b5136c983988630c_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_afc7b5439a4f273a0b5136c983988630c_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_afc7b5439a4f273a0b5136c983988630c_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,240,56"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="308,5,392,31"/>
<area shape="poly" title=" " alt="" coords="237,28,294,22,294,27,237,33"/>
<area shape="rect" href="../../d6/dce/cic_8cu.html#aa574c845e54a29eb9a143efa0ed493b2" title=" " alt="" coords="288,55,412,80"/>
<area shape="poly" title=" " alt="" coords="241,53,274,57,274,62,240,58"/>
</map>
</div>

</div>
</div>
<a id="a2e294634a2863de32ac3943d827c68c8" name="a2e294634a2863de32ac3943d827c68c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e294634a2863de32ac3943d827c68c8">&#9670;&#160;</a></span>UpdateVelocities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::UpdateVelocities </td>
          <td>(</td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/df0/classHACCGPM_1_1Timestepper.html">HACCGPM::Timestepper</a>&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/dce/cic_8cu_source.html#l00214">214</a> of file <a class="el" href="../../d6/dce/cic_8cu_source.html">cic.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  214</span>                                                                                                                                         {</div>
<div class="line"><span class="lineno">  215</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordtype">int</span> numBlocks = (ng*ng*ng)/blockSize;</div>
<div class="line"><span class="lineno">  217</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">  218</span><span class="preprocessor">    #ifdef VerboseUpdate</span></div>
<div class="line"><span class="lineno">  219</span>    printf(<span class="stringliteral">&quot;%sUpdate Velocities was called with\n%s   blockSize %d\n%s   numBlocks %d\n&quot;</span>,indent,indent,blockSize,indent,numBlocks);</div>
<div class="line"><span class="lineno">  220</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a12c2adcc2ffa6bc49dfff4a7f1cddf68">UPDATE_VEL_KERNEL_TIME</a> += <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a426f47de81eb03392ad93bb0e34433b2">InvokeGPUKernel</a>(<a class="code hl_function" href="../../d6/dce/cic_8cu.html#a7c201279a51dea9ece4f7613fd5787dd">ICICKernel</a>,numBlocks,blockSize,d_vel,d_grad,d_pos,ts.<a class="code hl_variable" href="../../db/df0/classHACCGPM_1_1Timestepper.html#adfdf31cff6181c0620faede8a70baa5b">deltaT</a>,ts.<a class="code hl_variable" href="../../db/df0/classHACCGPM_1_1Timestepper.html#a0bd90d6926912b009519e60d43f4b81a">fscal</a>,ng);</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">  224</span>    printf(<span class="stringliteral">&quot;%s   UpdateVelocities took %llu us\n&quot;</span>,indent,t);</div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a0286a91f200b88746649daf40cc0dab5">UPDATE_VEL_TIME</a> += t;</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_variable" href="../../d6/dce/cic_8cu.html#a75f88d15f42ff6a8d6da001a58c08093">UPDATE_VEL_CALLS</a> += 1;</div>
<div class="line"><span class="lineno">  227</span>}</div>
<div class="ttc" id="acic_8cu_html_a7c201279a51dea9ece4f7613fd5787dd"><div class="ttname"><a href="../../d6/dce/cic_8cu.html#a7c201279a51dea9ece4f7613fd5787dd">ICICKernel</a></div><div class="ttdeci">__global__ void ICICKernel(float4 *__restrict d_vel, const float4 *__restrict d_grad, const float4 *__restrict my_pos, double deltaT, double fscal, int ng)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dce/cic_8cu_source.html#l00036">cic.cu:36</a></div></div>
<div class="ttc" id="aclassHACCGPM_1_1Timestepper_html_a0bd90d6926912b009519e60d43f4b81a"><div class="ttname"><a href="../../db/df0/classHACCGPM_1_1Timestepper.html#a0bd90d6926912b009519e60d43f4b81a">HACCGPM::Timestepper::fscal</a></div><div class="ttdeci">double fscal</div><div class="ttdef"><b>Definition</b> <a href="../../da/d0d/haccgpm_8hpp_source.html#l00106">haccgpm.hpp:106</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00104">HACCGPM::Timestepper::deltaT</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00106">HACCGPM::Timestepper::fscal</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00036">ICICKernel()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00039">InvokeGPUKernel</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00017">UPDATE_VEL_CALLS</a>, <a class="el" href="../../d6/dce/cic_8cu_source.html#l00016">UPDATE_VEL_KERNEL_TIME</a>, and <a class="el" href="../../d6/dce/cic_8cu_source.html#l00015">UPDATE_VEL_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a2e294634a2863de32ac3943d827c68c8_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a2e294634a2863de32ac3943d827c68c8_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a2e294634a2863de32ac3943d827c68c8_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a2e294634a2863de32ac3943d827c68c8_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,243,56"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="292,5,376,31"/>
<area shape="poly" title=" " alt="" coords="229,28,278,22,279,27,230,33"/>
<area shape="rect" href="../../d6/dce/cic_8cu.html#a7c201279a51dea9ece4f7613fd5787dd" title=" " alt="" coords="291,55,377,80"/>
<area shape="poly" title=" " alt="" coords="235,53,277,58,277,63,235,59"/>
</map>
</div>

</div>
</div>
<a id="a56967323163b51e64180118159a654c2" name="a56967323163b51e64180118159a654c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56967323163b51e64180118159a654c2">&#9670;&#160;</a></span>writeOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HACCGPM::serial::writeOutput </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float4 *&#160;</td>
          <td class="paramname"><em>d_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calls</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d85/io_8cu_source.html#l00008">8</a> of file <a class="el" href="../../dd/d85/io_8cu_source.html">io.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    8</span>                                                                                           {</div>
<div class="line"><span class="lineno">    9</span> </div>
<div class="line"><span class="lineno">   10</span>    <a class="code hl_define" href="../../d1/dc2/ccamb_8c.html#aede6a850e442b96dd236d1bed8bf19e5">getIndent</a>(calls);</div>
<div class="line"><span class="lineno">   11</span> </div>
<div class="line"><span class="lineno">   12</span>    printf(<span class="stringliteral">&quot;%swriteOutput was called\n&quot;</span>,indent);</div>
<div class="line"><span class="lineno">   13</span> </div>
<div class="line"><span class="lineno">   14</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> start = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>    <span class="keywordtype">int</span> n_particles = ng*ng*ng;</div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordtype">float</span>* h_pos = (<span class="keywordtype">float</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*4*n_particles);</div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordtype">float</span>* h_vel = (<span class="keywordtype">float</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*4*n_particles);</div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemcpy, h_pos, d_pos, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*ng*ng*ng*4, cudaMemcpyDeviceToHost);</div>
<div class="line"><span class="lineno">   21</span>    <a class="code hl_define" href="../../da/d0d/haccgpm_8hpp.html#a28fb452217abf040d6df7890f94a54b9">cudaCall</a>(cudaMemcpy, h_vel, d_vel, <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*ng*ng*ng*4, cudaMemcpyDeviceToHost);</div>
<div class="line"><span class="lineno">   22</span> </div>
<div class="line"><span class="lineno">   23</span>    FILE *fp;</div>
<div class="line"><span class="lineno">   24</span>    fp = fopen(fname, <span class="stringliteral">&quot;w+&quot;</span>);</div>
<div class="line"><span class="lineno">   25</span>    fwrite(h_pos,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),4*n_particles,fp);</div>
<div class="line"><span class="lineno">   26</span>    fwrite(h_vel,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>),4*n_particles,fp);</div>
<div class="line"><span class="lineno">   27</span>    fclose(fp);</div>
<div class="line"><span class="lineno">   28</span>    free(h_pos);</div>
<div class="line"><span class="lineno">   29</span>    free(h_vel);</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> end = <a class="code hl_function" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6">CPUTimer</a>();</div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_typedef" href="../../da/d0d/haccgpm_8hpp.html#aa790b6767cf9152c32b179d29c46e3ef">CPUTimer_t</a> t = end-start;</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>    printf(<span class="stringliteral">&quot;%s   writeOutput took %llu us\n&quot;</span>,indent,t);</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_variable" href="../../dd/d85/io_8cu.html#a7c1af194f729e11f1fc192111adb21ff">OUTPUT_CALLS</a>++;</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_variable" href="../../dd/d85/io_8cu.html#a35c720fada5b8c3ff17c1ba734476094">OUTPUT_TIME</a> += t;</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00014">CPUTimer()</a>, <a class="el" href="../../da/d0d/haccgpm_8hpp_source.html#l00037">cudaCall</a>, <a class="el" href="../../d1/dc2/ccamb_8c_source.html#l00009">getIndent</a>, <a class="el" href="../../dd/d85/io_8cu_source.html#l00006">OUTPUT_CALLS</a>, and <a class="el" href="../../dd/d85/io_8cu_source.html#l00005">OUTPUT_TIME</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d15/driver_8cpp_source.html#l00012">serial()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d07/namespaceHACCGPM_1_1serial_a56967323163b51e64180118159a654c2_cgraph.png" border="0" usemap="#ad5/d07/namespaceHACCGPM_1_1serial_a56967323163b51e64180118159a654c2_cgraph" alt=""/></div>
<map name="ad5/d07/namespaceHACCGPM_1_1serial_a56967323163b51e64180118159a654c2_cgraph" id="ad5/d07/namespaceHACCGPM_1_1serial_a56967323163b51e64180118159a654c2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,211,31"/>
<area shape="rect" href="../../da/d0d/haccgpm_8hpp.html#a78588985bccaffcba4aa40467d7961d6" title=" " alt="" coords="259,5,343,31"/>
<area shape="poly" title=" " alt="" coords="211,15,245,15,245,21,211,21"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/d1c/namespaceHACCGPM.html">HACCGPM</a></li><li class="navelem"><a class="el" href="../../d5/d07/namespaceHACCGPM_1_1serial.html">serial</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
